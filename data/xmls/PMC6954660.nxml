<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">31197307</article-id><article-id pub-id-type="pmc">6954660</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btz453</article-id><article-id pub-id-type="publisher-id">btz453</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group subj-group-type="category-toc-heading"><subject>Gene Expression</subject></subj-group></subj-group></article-categories><title-group><article-title>DECENT: differential expression with capture efficiency adjustmeNT for single-cell RNA-seq data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Ye</surname><given-names>Chengzhong</given-names></name><xref ref-type="aff" rid="btz453-aff1">1</xref><xref ref-type="aff" rid="btz453-aff2">2</xref><xref ref-type="aff" rid="btz453-aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Speed</surname><given-names>Terence P</given-names></name><xref ref-type="aff" rid="btz453-aff1">1</xref><xref ref-type="aff" rid="btz453-aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Salim</surname><given-names>Agus</given-names></name><xref ref-type="corresp" rid="btz453-cor1"/><xref ref-type="aff" rid="btz453-aff1">1</xref><xref ref-type="aff" rid="btz453-aff5">5</xref><xref ref-type="aff" rid="btz453-aff6">6</xref><!--<email>a.salim@latrobe.edu.au</email>--></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Berger</surname><given-names>Bonnie</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="btz453-aff1"><label>1</label>
<institution>Bioinformatics Division, Walter and Eliza Hall Institute of Medical Research</institution>, Parkville, VIC, <country country="AU">Australia</country></aff><aff id="btz453-aff2"><label>2</label>
<institution>Department of Medical Biology, The University of Melbourne</institution>, Parkville, VIC, <country country="AU">Australia</country></aff><aff id="btz453-aff3"><label>3</label>
<institution>School of Medicine, Tsinghua University, Haidian District</institution>, Beijing, <country country="CN">China</country></aff><aff id="btz453-aff4"><label>4</label>
<institution>Department of Mathematics and Statistics, The University of Melbourne</institution>, Parkville, VIC, <country country="AU">Australia</country></aff><aff id="btz453-aff5"><label>5</label>
<institution>Department of Mathematics and Statistics, La Trobe University</institution>, Bundoora, VIC, <country country="AU">Australia</country></aff><aff id="btz453-aff6"><label>6</label>
<institution>Baker Heart and Diabetes Institute</institution>, Melbourne, VIC, <country country="AU">Australia</country></aff><author-notes><corresp id="btz453-cor1">To whom correspondence should be addressed. E-mail: <email>a.salim@latrobe.edu.au</email></corresp></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-06-14"><day>14</day><month>6</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>14</day><month>6</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>24</issue><fpage>5155</fpage><lpage>5162</lpage><history><date date-type="received"><day>23</day><month>10</month><year>2018</year></date><date date-type="rev-recd"><day>08</day><month>5</month><year>2019</year></date><date date-type="accepted"><day>06</day><month>6</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><self-uri xlink:href="btz453.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Dropout is a common phenomenon in single-cell RNA-seq (scRNA-seq) data, and when left unaddressed it affects the validity of the statistical analyses. Despite this, few current methods for differential expression (DE) analysis of scRNA-seq data explicitly model the process that gives rise to the dropout events. We develop DECENT, a method for DE analysis of scRNA-seq data that explicitly and accurately models the molecule capture process in scRNA-seq experiments.</p></sec><sec id="s2"><title>Results</title><p>We show that DECENT demonstrates improved DE performance over existing DE methods that do not explicitly model dropout. This improvement is consistently observed across several public scRNA-seq datasets generated using different technological platforms. The gain in improvement is especially large when the capture process is overdispersed. DECENT maintains type I error well while achieving better sensitivity. Its performance without spike-ins is almost as good as when spike-ins are used to calibrate the capture model.</p></sec><sec id="s3"><title>Availability and implementation</title><p>The method is implemented as a publicly available R package available from <ext-link ext-link-type="uri" xlink:href="https://github.com/cz-ye/DECENT">https://github.com/cz-ye/DECENT</ext-link>.</p></sec><sec id="s4"><title>Supplementary information</title><p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Australian National Health and Medical Research Council Program</named-content></funding-source><award-id>105461</award-id></award-group></funding-group><counts><page-count count="8"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Recent developments in sequencing technology have enabled high-throughput whole-transcriptome profiling at single-cell resolution. Single-cell RNA-seq (scRNA-seq) allows the quantification of gene expression of thousands of individual cells in a single experiment. It has already led to profound new discoveries that could not be have been made using data from bulk transcriptome sequencing, ranging from the identification of novel cell types to the study of global patterns of stochastic gene expression (<xref rid="btz453-B16" ref-type="bibr">Kolodziejczyk <italic>et al.</italic>, 2015</xref>; <xref rid="btz453-B38" ref-type="bibr">Wagner <italic>et al.</italic>, 2016</xref>). However, there are still many statistical challenges in drawing inferences from scRNA-seq data. Due to the small amount of starting material and the imperfect capturing of RNA molecules in current scRNA-seq experiments, failure to detect expressed transcripts in single cells is still common. This gives rise to the characteristic dropout phenomenon in scRNA-seq data, in which a gene shows zero or very low abundance in a fraction of cells in spite of moderate to high expression in others (<xref rid="btz453-B5" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>; <xref rid="btz453-B7" ref-type="bibr">Hashimshony <italic>et al.</italic>, 2012</xref>; <xref rid="btz453-B25" ref-type="bibr">Ramskold <italic>et al.</italic>, 2012</xref>). Also, the capture rates can vary between cells and across genes (<xref rid="btz453-B2" ref-type="bibr">Brennecke <italic>et al.</italic>, 2013</xref>), showing as a major source of unwanted variation in scRNA-seq data, with the first principal component of raw counts typically exhibiting high correlation with the proportions of zero counts (<xref rid="btz453-B26" ref-type="bibr">Risso <italic>et al.</italic>, 2018</xref>). This unique feature of scRNA-seq will hinder downstream analyses if not properly modeled. Lots of effort has been made in order to alleviate this issue, including specialized normalization methods (<xref rid="btz453-B1" ref-type="bibr">Bacher <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B19" ref-type="bibr">Lun <italic>et al.</italic>, 2016</xref>), clustering algorithms (<xref rid="btz453-B14" ref-type="bibr">Kiselev <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B39" ref-type="bibr">Wang <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B41" ref-type="bibr">Zeisel <italic>et al.</italic>, 2015</xref>) and methods for differential expression analysis (<xref rid="btz453-B5" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>; <xref rid="btz453-B11" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B13" ref-type="bibr">Kharchenko <italic>et al.</italic>, 2014</xref>). </p><p>One way to resolve this is through explicit modeling of the molecule capturing process and hence separating the biological variation of interest from unwanted variation in the experimental procedures. For instance, several methods (<xref rid="btz453-B8" ref-type="bibr">Huang <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B36" ref-type="bibr">van Dijk <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B39" ref-type="bibr">Wang <italic>et al.</italic>, 2018</xref>) are designed to recover the pre-dropout expression matrix by modeling the process from RNA molecule to read count. However, a difficulty in modeling the molecule capturing and dropout events is that this process is usually mixed up with other sources of technical variation, such as amplification and sequencing biases (<xref rid="btz453-B38" ref-type="bibr">Wagner <italic>et al.</italic>, 2016</xref>). The unique molecular identifier (UMI) barcoding approach has become increasingly popular in scRNA-seq experiments as an effective way to address this issue (<xref rid="btz453-B9" ref-type="bibr">Islam <italic>et al.</italic>, 2014</xref>; <xref rid="btz453-B32" ref-type="bibr">Svensson <italic>et al.</italic>, 2017</xref>). Random barcodes are attached to cDNA molecules during reverse transcription. Each individual molecule from a particular gene in each cell is expected to have a distinct UMI (<xref rid="btz453-B9" ref-type="bibr">Islam <italic>et al.</italic>, 2014</xref>). Therefore, after sequencing, by counting UMI barcodes instead of reads per se, the resulting UMI counts will be a more faithful representation of the original cDNA counts, with amplification and sequencing bias largely avoided. But the UMI count will still show as zero if an RNA molecule failed to convert to cDNA, or was completely lost in amplification and sequencing.</p><p>As a consequence, the main source of technical variation left in UMI counts is the loss of molecules during the experimental procedure, namely, dropouts. Hence, UMI count data provides us with an opportunity to model the molecule capturing process in depth. Also, given the distinct features of UMI-based data, it is necessary to build specific models in order to perform statistical tests reliably.</p><p>Currently scRNA-seq experiments mainly focus on cell-wise analyses such as clustering and trajectory inference for studying heterogeneity within cellular populations (<xref rid="btz453-B23" ref-type="bibr">Qiu <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B33" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>; <xref rid="btz453-B41" ref-type="bibr">Zeisel <italic>et al.</italic>, 2015</xref>). Nevertheless, differential gene expression (DE), as one of the most common gene-wise analyses, still plays an essential role in complementing these analyses. For example, it is used to identify cluster-specific markers for identifying the cell types. It is also used to derive disease-associated gene signatures (<xref rid="btz453-B29" ref-type="bibr">Savas <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B31" ref-type="bibr">Sun <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B42" ref-type="bibr">Zhao <italic>et al.</italic>, 2017</xref>). However, DE methods originally designed for bulk RNA-seq tend to produce unreliable results due to failing to account for the extra variation in single-cell data (<xref rid="btz453-B11" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B35" ref-type="bibr">Van den Berge <italic>et al.</italic>, 2018</xref>). Driven by this, a few DE methods have been designed specifically for scRNA-seq data. All of them use some strategy to deal with the large variation and number of zero observations. However, most of them do not distinguish biological from technical factors that are causing the phenomenon. For example, SCDE (<xref rid="btz453-B13" ref-type="bibr">Kharchenko <italic>et al.</italic>, 2014</xref>) uses a mixture model to distinguish counts affected by dropout from the rest of the data. This model almost always assigns a probability of one that a zero count belongs to the dropout component, in essence assuming all observed zeroes to be technical. MAST (<xref rid="btz453-B5" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>) uses a two-part generalized linear model (GLM) in which the dropout rates are adjusted by the inclusion of the observed fraction of non-zero counts as a term in their regression model. This still does not differentiate the dropouts from real biological zeros. Additionally, the effect of dropout events is likely to be non-linear, especially for genes with low to moderate expression (<xref rid="btz453-B1" ref-type="bibr">Bacher <italic>et al.</italic>, 2017</xref>), and so the inclusion of simple linear term that represents capture rates in the regression model is unlikely to be optimal. Zero-inflated negative binomial (ZINB)-WaVE (<xref rid="btz453-B35" ref-type="bibr">Van den Berge <italic>et al.</italic>, 2018</xref>) uses a zero-inflated model directly fitted to the observed data to derive observation weights for adjusting bulk DE methods. Only <xref rid="btz453-B11" ref-type="bibr">Jia <italic>et al.</italic> (2017)</xref> proposed a DE method, TASC, that relies on external RNA spike-in data (<xref rid="btz453-B12" ref-type="bibr">Jiang <italic>et al.</italic>, 2011</xref>) to fit a technical variation model in order to explicitly cater for dropouts, thus enabling separation of the biological variation for DE analysis. They showed improved performance of their method compared with methods that perform DE analysis directly using the observed data. Note that the methods mentioned so far are not specifically designed for UMI-count data. There are two existing methods that considers the unique features of UMI-based experiments: Monocle2 (<xref rid="btz453-B23" ref-type="bibr">Qiu <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B33" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>) and NBID (<xref rid="btz453-B3" ref-type="bibr">Chen <italic>et al.</italic>, 2018</xref>). They both fit negative binomial (NB) models directly to the observed UMI count without any explicit modeling of dropouts.</p><p>Here we propose a novel model for the DE analysis of UMI-based scRNA-seq data. Leveraging the features UMI-count data, we are able to model the molecule capturing process precisely. We build a capture model to account for the gene- and cell-specific properties of molecule capturing. This allows us to perform DE analysis on the inferred pre-dropout distributions of RNA molecules. We named our method <italic>D</italic>ifferential <italic>E</italic>xpression with <italic>C</italic>apture <italic>E</italic>fficiency adjustme<italic>NT</italic> (DECENT). DECENT can use the external RNA spike-in data to calibrate the capture model, but also works without spike-ins. In this paper, we describe the DECENT model and benchmark it against existing methods using both simulated data and four published UMI-based scRNA-seq datasets. The results showed improved performance of DECENT in various settings when compared with existing methods.</p></sec><sec><title>2 Materials and methods</title><sec><title>2.1 Model formulation</title><p>DECENT assumes that UMIs (<xref rid="btz453-B9" ref-type="bibr">Islam <italic>et al.</italic>, 2014</xref>) have been used in the scRNA-seq experiment. Our statistical model is hierarchical, involving modelling the observed count <italic>Z<sub>ij</sub></italic> of mRNA molecules &#x02018;captured&#x02019; from gene <italic>i</italic> in cell <italic>j</italic>, and the unobserved total mRNA count <italic>Y<sub>ij</sub></italic> of all mRNA molecules from gene <italic>i</italic> in cell <italic>j</italic> that could have been captured had there been no molecule dropout. We will subsequently use the term &#x02018;pre-dropout count&#x02019; when referring to <italic>Y<sub>ij</sub></italic>. Cells will in general be of more than one type, and our inferences will concern the mean parameters <italic>&#x003bc;<sub>ij</sub></italic> of the distribution of the unobserved pre-dropout count across cell types. Other parameters in our model for the unobserved pre-dropout count are zero inflation parameters <italic>&#x003c0;</italic><sub>0</sub><sub><italic>i</italic></sub> and (over) dispersion parameters <italic>&#x003c8;<sub>i</sub></italic> specific to gene <italic>i</italic>, and a size-factor parameter <italic>s<sub>j</sub></italic> specific to cell <italic>j</italic>, to account for differences in total mRNA molecules across cells. To summarize, we use ZINB distribution with the following probability density function to model the unobserved pre-dropout count:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>&#x003c8;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mfrac><mml:mrow><mml:mo>&#x00393;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>!</mml:mo><mml:mo>&#x00393;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>&#x003c8;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mo>&#x003c8;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mo>&#x003c8;</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0.</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Note that, as <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, our ZINB model reduced to a zero-inflated Poisson model (ZIP). When <italic>&#x003c0;</italic><sub>0</sub><sub><italic>i</italic></sub>&#x000a0;=0, our model reduces to the NB model and finally when <italic>&#x003c0;</italic><sub>0</sub><sub><italic>i</italic></sub>&#x000a0;=0 and <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, our model reduces to the Poisson model.</p><p>The second part of the DECENT model involves the specification of the capture model for modelling the distribution of the observed data <italic>Z<sub>ij</sub></italic> given the unobserved pre-dropout count <italic>Y<sub>ij</sub></italic>. We use a binomial model for the molecule capture, assuming <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>&#x003b7;<sub>ij</sub></italic> is the capture rates for gene <italic>i</italic> within cell <italic>j</italic>. The probability density function for the capture model is given by,
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></disp-formula></p><p>Finally, to account for variability in the capture rate, we assume a beta prior for the capture rate parameter <italic>&#x003b7;<sub>ij</sub></italic> with the prior mean equal to the cell-specific capture rates <italic>&#x003b7;<sub>j</sub></italic> and the prior variance characterized by a dispersion parameter <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c1;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c1;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. When <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c1;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, our capture model reduces to the standard Binomial model with all genes within a cell having the same capture rate, <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>. In our DECENT model, backed up by empirical evidence from published scRNA-seq datasets, we assume that the dispersion parameter is related to gene abundance through a logistic linear model:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c1;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c1;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are cell-specific parameters estimated from the data. In our experience with real datasets, we usually found that assuming global parameters <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> is adequate. Furthermore, from real datasets we also found that <italic>&#x003c4;</italic><sub>1</sub>&#x000a0;&#x0003c;0, which suggests that within a cell, capture rates for highly abundant genes vary around the cell-specific capture rates much less than the capture rates for low or moderately abundant genes. As an alternative to estimating a global <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> parameter, DECENT also has an option for estimating cell-specific <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> if there is evidence that the parameters vary significantly between cells.</p><p>Our hierarchical DECENT model specification can be summarized as follows:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>ZINB</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where the parameters of the beta prior for <italic>&#x003b7;<sub>ij</sub></italic> satisfy
<disp-formula id="E7"><mml:math id="M7"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003c1;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c1;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p><p>Next, we describe empirical evidence that motivated us to choose this specification for DECENT.</p><sec><title>2.1.1 Empirical evidence for beta-binomial capture model</title><p>We investigated the appropriateness of our capture model using six ERCC spike-in datasets, consisting of three plate-based (<xref rid="btz453-B6" ref-type="bibr">Grun <italic>et al.</italic>, 2014</xref>; <xref rid="btz453-B34" ref-type="bibr">Tung <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B41" ref-type="bibr">Zeisel <italic>et al.</italic>, 2015</xref>) and three droplet-based experiments (<xref rid="btz453-B15" ref-type="bibr">Klein <italic>et al.</italic>, 2015</xref>; <xref rid="btz453-B21" ref-type="bibr">Macosko <italic>et al.</italic>, 2015</xref>; <xref rid="btz453-B43" ref-type="bibr">Zheng <italic>et al.</italic>, 2017</xref>) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). We use spike-ins because their average (nominal) pre-dropout count are known, with no biological variation between cells expected. To model the distribution of their unobserved pre-dropout counts, we thus use a Poisson distribution with mean equal to the nominal count for each spike-in. The full results from all six datasets are shown in Supplementary Figure S2. But as an example, we will use results from the Tung <italic>et al.</italic> data as shown in <xref ref-type="fig" rid="btz453-F1">Figure&#x000a0;1</xref>. <xref ref-type="fig" rid="btz453-F1">Figure&#x000a0;1a</xref> shows that the simple Binomial capture model does not provide an adequate fit to the data because the deviance statistic (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>, pp. 13&#x02013;14) for this model is much larger than the expected distribution when the model is adequate. Further analyses suggests that variation in capture rates between spikes contribute to this inadequate fit (Supplementary Fig. S1). We therefore model this extra variation by allowing capture rates to have a beta prior with cell-specific mean and dispersion parameter that differs from one spike to another. We find that the dispersion parameter can be well-approximated by a linear logistic model as a function of the spikes&#x02019; abundance (<xref ref-type="fig" rid="btz453-F1">Fig.&#x000a0;1b</xref>). We then compare the fit of the beta-binomial capture model with the simple binomial model and find that the beta-binomial model provides much better fit to the data (<xref ref-type="fig" rid="btz453-F1">Fig.&#x000a0;1c</xref>). The same analyses were carried out using the spike-in data from the other five experiments and similar results were obtained (Supplementary Fig. S2). 
</p><fig id="btz453-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Modeling extra-binomial variation in the molecule capturing process. We evaluate the binomial and beta-binomial capture models using the ERCC spike-in data from the Tung <italic>et al.</italic> experiment. (<bold>a</bold>) The observed distribution (red) of deviances with cell-wise binomial capture model shows notable deviation from the expected <italic>&#x003c7;</italic><sup>2</sup> distribution under the null hypothesis. This indicates inadequacy of the binomial capture model. (<bold>b</bold>) Modeling the relationship between the spike-in nominal count <italic>c<sub>i</sub></italic> and the dispersion parameter <italic>&#x003c1;</italic> in the beta-binomial capture model. If the parameter is estimated in a spike-in specific manner, a high correlation between the <italic>&#x003c1;<sub>i</sub></italic> estimates and the true pre-dropout mean abundance, namely the nominal count <italic>c<sub>i</sub></italic>, can be observed, which are shown as black points. We build a cell-wise linear model to characterize this relationship. Each blue line represents a fitted cell-wise model, which is shown to adequately describe this relationship. (<bold>c</bold>) A scatter plot comparing the cell-wise deviances under the binomial and beta-binomial capture models to assess goodness-of-fit. Deviances were standardized by dividing by the degrees of freedom to enable comparison, and logged. The blue and red marginal densities represent the observed distributions of deviances under the two models, respectively. It can be seen that the beta-binomial capture model fits better than the binomial model in the majority of the cells</p></caption><graphic xlink:href="btz453f1"/></fig></sec><sec><title>2.1.2 Empirical evidence for pre-dropout count distribution</title><p>The ZINB distribution has two extra parameters when compared with the simple Poisson distribution for count data, namely the overdispersion and the zero-inflation parameters. To examine whether the ZINB distribution is needed for modelling the unobserved pre-dropout count, we used two scRNA-seq datasets (<xref rid="btz453-B34" ref-type="bibr">Tung <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B41" ref-type="bibr">Zeisel <italic>et al.</italic>, 2015</xref>). To investigate the need for overdispersion parameter, we first fit the DECENT model assuming a Poisson pre-dropout distribution to the data without considering zero-inflation. We found that the expected variances of most genes were noticeably lower than the observed values for the Zeisel <italic>et al.</italic> dataset. This extra variation was well-modeled by assuming NB as pre-dropout count distribution, hence indicating the need for the dispersion parameter (Supplementary Fig. S3a). For the Tung <italic>et al.</italic> data, the expected variances under the Poisson pre-dropout count assumption were already close to the observed values for most genes, showing little need for the extra parameter (Supplementary Fig. S3b). This suggests that overdispersion in pre-dropout counts is dataset-specific and depends on the amount of biological variability in the sample. The Tung <italic>et al.</italic> data used here are from one iPSC cell line where cells were highly homogeneous and hence lack biological variation. On the other hand, the Zeisel <italic>et al.</italic> data are from mouse brain tissue, which has a complex cellular composition. To investigate the need for zero-inflation parameter, we further fitted the DECENT model assuming a ZINB pre-dropout count distribution and compared this with the model that assumes NB pre-dropout count distribution. We performed chi-square goodness-of-fits test on the DECENT models with ZINB and NB pre-dropout count distribution to assess their adequacy. Consistent with previous findings (<xref rid="btz453-B3" ref-type="bibr">Chen <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B37" ref-type="bibr">Vieth <italic>et al.</italic>, 2017</xref>), the majority of genes do not appear to require zero-inflated model. However we still found a small number of genes in both datasets in which models with ZINB provide a more adequate fit than NB (Supplementary Fig. S4).</p><p>We also investigated the appropriateness of the ZINB distribution using a single-molecule fluorescence <italic>in situ</italic> hybridization (smFISH) dataset. The smFISH technology allows precise quantification of RNA molecules from a list of targeted genes. This technology can achieve nearly 100% sensitivity detection of the RNA molecules (<xref rid="btz453-B24" ref-type="bibr">Raj <italic>et al.</italic>, 2008</xref>). Hence, the smFISH count data is a good approximation to the pre-dropout molecule counts that would normally be unobserved. We used the data from an experiment that profiled 33 marker genes in mouse somatosensory cortex (<xref rid="btz453-B4" ref-type="bibr">Codeluppi <italic>et al.</italic>, 2018</xref>). We examined three of the clusters identified by the authors, Oligodendrocyte Mature, Pyramidal L4 and Inhibitory Vip, finding most of the gene count distributions to be significantly overdispersed relative to the Poisson (Supplementary Fig. S5a). Yet we did not find zero-inflated genes in these clusters. This is quite possibly because the targeted genes are all canonical markers, which are expected to mostly exhibit constitutive expression and hence unlikely to have inflated zeros caused by transcriptional bursting. However, heterogeneity within a population can also result in zero-inflation, which is common in actual DE analysis. When we looked at 3 major cell types with higher within-group heterogeneity (Oligodendrocytes, Pyramidal neurons and Inhibitory neurons), we identified 2, 1 and 2 out of the 33 genes to have significant zero-inflation (Supplementary Fig. S5b).</p></sec></sec><sec><title>2.2 Estimating capture rate parameters</title><p>Our capture model requires estimates of a cell-specific capture rate that will be used as part of the beta prior in the beta-binomial capture model. This capture rate needs to be estimated externally outside the main algorithm, for reasons that we will explain below. When the dataset contains spike-ins, their data are used to estimate the capture rates. Suppose we added <italic>n<sub>s</sub></italic> spike-ins at the known concentrations <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> into cell <italic>j</italic> and subsequently observe <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> molecules respectively. The cell-specific capture efficiency for any cell <italic>j</italic> is estimated as the proportion of molecules observed after sequencing relative to the total number of molecules initially added:
<disp-formula id="E8"><mml:math id="M8"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p><p>This is the method of moments estimator of the capture rate <italic>&#x003b7;<sub>j</sub></italic> under the beta-binomial-Poisson model for spike-ins.</p><p>However, many scRNA-seq data do not have spike-ins. Interestingly, we found that if we specified a set of inexact capture rates, other components of the model will compensate for the inaccuracy and produce DE results almost as reliable as if we had the correct values. This is due to a property of the our model that is explained below:</p><p>Let <italic>Y</italic> be the unobserved pre-dropout count where <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>ZINB</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>&#x003bc;</mml:mo><mml:mo>,</mml:mo><mml:mo>&#x003c8;</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>|</mml:mo><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>;</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo>-</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, with the capture rate given by <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mo>&#x003b7;</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi>a</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. It turns out that the marginal distribution of <italic>Z</italic> in this case is almost indistinguishable from the marginal distribution of <italic>Z</italic> when the capture rate is <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mo>&#x003b7;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:math></inline-formula> and the size-factor parameter of the ZINB distribution is <italic>s</italic>&#x02032;=<italic>s</italic>(<italic>&#x003b7;</italic>/<italic>&#x003b7;</italic>&#x02032;) (see Supplementary Fig. S6). This feature means that if we incorrectly specify the capture rate as <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mo>&#x003b7;</mml:mo><mml:mo>&#x02032;</mml:mo></mml:mrow></mml:math></inline-formula> rather than <italic>&#x003b7;</italic>, the misspecification can be approximately corrected by scaling the size factor estimates accordingly. Nevertheless, it is still preferable to get capture efficiency estimates as close as possible to the true value. This identifiability issue involving a cell&#x02019;s size-factor and capture rate parameter also means that it is nearly impossible to simultaneously estimate these parameters inside the main algorithm. Our approach here is to estimate the capture rate parameters before invoking the expectation conditional maximization (ECM) algorithm, and given these, we estimate the size-factor parameters within the ECM algorithm.</p><p>Motivated by the above results and our experience with real datasets showing that capture efficiency is the biggest factor contributing to the variation in the observed library sizes, we devised a method for generating functional capture rates when spike-ins are not available. We refer to this as the ranked random capture efficiency. To use this method, users will need to specify an interval of plausible capture rate parameters in their experiment. DECENT uses <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.02</mml:mn><mml:mo>,</mml:mo><mml:mn>0.10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as its default and we have found this to work well in all the datasets without spike-ins that we have analyzed. As an alternative, users can refer to <xref rid="btz453-B44" ref-type="bibr">Ziegenhain <italic>et al.</italic> (2017)</xref> for guidance on plausible range of capture rate parameters across various different sequencing protocols.</p><p>Let the lower and upper bounds of capture rates be <italic>&#x003b7;</italic><sub>min</sub> and <italic>&#x003b7;</italic><sub>max</sub>, respectively. The cell-specific capture rates are specified as follows:
<list list-type="bullet"><list-item><p>Compute library size for each cell and denote the <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of these by <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <italic>n</italic> is the number of cells. To minimize the impact of a few genes having very large counts, we can also use trimmed sums instead of full sums here. Denote the minimum and maximum <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>&#x02009;</mml:mo><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> library size as <italic>L</italic><sub>min</sub> and <italic>L</italic><sub>max</sub>.</p></list-item><list-item><p>Calculate weight for cell <italic>j</italic> as <italic>w<sub>j</sub></italic>=<italic>L<sub>j</sub></italic>&#x02212;<italic>L</italic><sub>min</sub>/<italic>L</italic><sub>max</sub>&#x02212;<italic>L</italic><sub>min</sub>.</p></list-item><list-item><p>Estimate the capture efficiency for cell <italic>j</italic> as <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. This ensures that cells with larger library size will have larger capture efficiency and the capture efficiency estimates are bounded within the <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> interval.</p></list-item></list></p></sec><sec><title>2.3 Parameter estimation and DE analyses</title><p>DECENT&#x02019;s main aim is to estimate parameters of the unobserved pre-dropout count and perform statistical inference on these parameters for the purpose of identifying differentially expressed genes (DEGs). Because the pre-dropout count is unobserved, we use an ECM algorithm to estimate these parameters (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref> for details). The algorithm works as follows:
<list list-type="order"><list-item><p>First, capture rate parameters <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are estimated prior to invoking the ECM algorithm.</p></list-item><list-item><p>Given the capture rates, initial estimates of cell-specific size factor parameters <italic>s<sub>j</sub></italic> and gene-specific parameters <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c0;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, as well as <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mrow><mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003c4;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, the parameters that control the uncertainties in the beta prior for capture rates are calculated using method-of-moment approaches, assuming no DE genes and a simple Binomial capture model.</p></list-item><list-item><p>Perform an E-step to estimate the following conditional expectations given the observed count: <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b7;</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>For each gene, perform an M-step to update the gene-specific parameters <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref> for details).</p></list-item><list-item><p>For each cell, perform an M-step to update the cell-specific size-factor parameters <italic>s<sub>j</sub></italic> (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref> for details).</p></list-item><list-item><p>Perform an M-step to update the (possibly) cell-specific parameters of the beta prior for capture rates, <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref> for details).</p></list-item><list-item><p>Iterate between step [2] to [5] until convergence is achieved.</p></list-item></list></p><p>To facilitate DE analysis, the gene-wise mean parameter <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mi mathvariant="bold">&#x003bc;</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is assumed to depend on the cell type or group through a log-linear model:
<disp-formula id="E9"><mml:math id="M9"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:mi mathvariant="bold">&#x003bc;</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow></mml:math></disp-formula>where <bold>X</bold> is the design matrix providing group information and <inline-formula id="IE34"><mml:math id="IM34"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:math></inline-formula> are the coefficients. We also allow the mean parameter to depend on cell-wise covariates <bold>W</bold> to remove unwanted variation (e.g. batch effects, cell-cycle phases). In the most common two group comparisons, we have
<disp-formula id="E10"><mml:math id="M10"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003bc;</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula>where <italic>x<sub>j</sub></italic> is simply the binary indicator of cellular group, <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is logarithm of mean parameter for gene <italic>i</italic> in the reference cell type, <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the log fold-change parameter for gene <italic>i</italic> and the <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the gene-specific regression coefficients that adjust the DE analysis for the unwanted, cell-specific factors <italic>w<sub>j</sub></italic>.</p><p>Differential expression across two cellular groups for the gene <italic>i</italic> is assessed by testing the hypotheses:
<disp-formula id="E11"><mml:math id="M11"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>&#x02003;</mml:mo><mml:mtext>versus</mml:mtext><mml:mo>&#x02003;</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02260;</mml:mo><mml:mn>0</mml:mn></mml:math></disp-formula>using the likelihood ratio test statistic,
<disp-formula id="E12"><mml:math id="M12"><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>&#x02113;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi>&#x02113;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003b8;</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the maximum likelihood estimator (MLE) of <italic>&#x003b8;<sub>i</sub></italic> under the restriction that <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msub><mml:mrow><mml:mo>&#x003b2;</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02009;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the MLE under the unrestricted model and <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x02113;</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the log-likelihood based on the observed data <italic>Z<sub>ij</sub></italic> [see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>; Equation (9)]. For simple two cell type comparisons, the statistic is approximately distributed as <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003c7;</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal">2</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> under <italic>H</italic><sub>0</sub>. More generally, when performing DE across <italic>p</italic> different cell types or conditions, the statistic is approximately distributed as <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>&#x003c7;</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> under <italic>H</italic><sub>0</sub>.</p></sec></sec><sec><title>3 Results</title><sec><title>3.1 Benchmarking using simulated data</title><p>We simulated 20 datasets, each consisting of 500 cells belonging to 2 cell types (224 cells from cell type 1 versus 276 cells from cell type 2) with 3000 endogenous genes and 50 spike-ins. The observed count were generated under the DECENT model using parameters estimated from Tung&#x02019;s dataset (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref> for details). In each dataset, we set &#x0223c;10% of the genes to be DEGs. <xref ref-type="fig" rid="btz453-F2">Figure&#x000a0;2</xref> shows that DECENT estimates gene-specific pre-dropout proportion of zeroes and variance, as well as the actual pre-dropout counts unbiasedly. <xref ref-type="fig" rid="btz453-F3">Figure&#x000a0;3</xref> shows that DECENT&#x02019;s performance in detecting DEGs also appear to be competitive when compared with existing methods, namely SCDE (<xref rid="btz453-B13" ref-type="bibr">Kharchenko <italic>et al.</italic>, 2014</xref>), MAST (<xref rid="btz453-B5" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>), Monocle2 (<xref rid="btz453-B23" ref-type="bibr">Qiu <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B33" ref-type="bibr">Trapnell <italic>et al.</italic>, 2014</xref>), ZINB-WaVE adjusted edgeR (<xref rid="btz453-B35" ref-type="bibr">Van den Berge <italic>et al.</italic>, 2018</xref>) and edgeR (<xref rid="btz453-B22" ref-type="bibr">McCarthy <italic>et al.</italic>, 2012</xref>). Over the 20 datasets, the mean(SD) of the partial area under the receiver operating characteristic (pAUROC) for DECENT is 0.708(0.001), followed by MAST with 0.687(0.001) (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). DECENT&#x02019;s performance also appears to be relatively robust to misspecification of capture rates parameters (Supplementary Fig. S7).
</p><fig id="btz453-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Inferring pre-dropout molecule counts in simulation. (<bold>a</bold>) Scatter plot comparing for each gene the estimated proportion of zeros of the fitted pre-dropout distribution with the true proportion of zeros in the pre-dropout counts. (<bold>b</bold>) Scatter plot comparing the expected variance of the fitted pre-dropout distribution with the true gene-wise variance in the pre-dropout counts. (<bold>c</bold>) Scatter plot comparing the expected value of pre-dropout counts (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref> for details) under the fitted model with the true pre-dropout counts. We shows a random subsample of 5% of all the non-zero counts. The estimated pre-dropout counts used to calculate (<bold>a</bold>) and (<bold>b</bold>) were based on single imputation, i.e. drawing a single value from the conditional pre-dropout distribution for each gene and each cell given the observed data. The estimated pre-dropout counts shown in (<bold>c</bold>) were calculated as the expected value of the conditional pre-dropout distribution (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>)</p></caption><graphic xlink:href="btz453f2"/></fig><fig id="btz453-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Differential expression analysis of simulated data. (<bold>a</bold>) Partial receiver operating characteristic curve for differential expression methods on the simulated data. (<bold>b</bold>) False discovery rate curves for differential expression methods on the simulated data. Both curves only focus on the low <italic>P</italic>-value region, since other regions were of little interest in actual DE analysis. Z-edgeR stands for ZINB-WaVE-adjusted edgeR</p></caption><graphic xlink:href="btz453f3"/></fig></sec><sec><title>3.2 Benchmarking using real data</title><p>We further benchmarked our method against existing methods using real datasets. The difficulty in benchmarking using real datasets is that the genuine DEGs are usually unknown. In order to obtain a credible list of genuine DEGs, we searched for scRNA-seq datasets that have matching bulk RNA-seq experiments, which means a bulk RNA-seq was also performed using cells from exactly the same tissues or cell lines. We found four such experiments in total that also used UMI. Then a DEG list derived from these bulk data can be used as the reference set for benchmarking. These includes two plate-based experiments and two droplet-based experiments, with different scales, sources of tissues or cell lines and observed proportion of zero counts (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>) (<xref rid="btz453-B3" ref-type="bibr">Chen <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B29" ref-type="bibr">Savas <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B30" ref-type="bibr">Soumillon <italic>et al.</italic>, 2014</xref>; <xref rid="btz453-B34" ref-type="bibr">Tung <italic>et al.</italic>, 2017</xref>). We use these datasets to benchmark DECENT against existing methods (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>: Benchmarking for more details about these datasets).</p><p>The same existing methods were benchmarked using all four datasets, except that we also applied TASC to the Tung <italic>et al.</italic> data where spike-ins are available. All of these datasets have gone through careful quality control steps by the authors of the original publications. Therefore, we do not further filter any cells. The only further filtering we perform is filtering very low abundance genes that correspond to the second peak in the histogram of average gene count distribution (Supplementary Fig. S13). We fitted the DECENT model to all four datasets and found that a global <inline-formula id="IE43"><mml:math id="IM43"><mml:mi mathvariant="bold-italic">&#x003c4;</mml:mi></mml:math></inline-formula> parameter was adequate for all datasets, except Tung&#x02019;s where substantial variation in the <italic>&#x003c4;</italic><sub>0</sub> and <italic>&#x003c4;</italic><sub>1</sub> parameters was observed (Supplementary Fig. S14). As shown in <xref ref-type="fig" rid="btz453-F4">Figures&#x000a0;4</xref> and <xref ref-type="fig" rid="btz453-F5">5</xref>, DECENT showed superior performance on all four datasets. In particular, DECENT performs better than other methods for the Soumillon and Chen datasets where the dispersion parameters for the beta prior are larger and thus the capture models are more overdispersed relative to the Binomial model (Supplementary Fig. S15).
</p><fig id="btz453-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>Partial receiver operating characteristic curves for differential expression methods on real datasets. Evaluating the performance of different methods by partial receiver operating characteristic curves using the (<bold>a</bold>) Tung <italic>et al.</italic>, (<bold>b</bold>) Soumillon <italic>et al.</italic>, (<bold>c</bold>) Savas <italic>et al.</italic> and (<bold>d</bold>) Chen <italic>et al.</italic> datasets. DEGs from matching bulk RNA-seq data were used as gold-standard for benchmarking. DECENT achieves competitive accuracy of identifying genuine DEGs in all four datasets. We used pROC to focus on the low <italic>P</italic>-value region with high specificity. DE methods are denoted by different colors. Z-edgeR stands for ZINB-WaVE-adjusted edgeR. TASC requires spike-ins and was only evaluated using the Tung <italic>et al.</italic> data </p></caption><graphic xlink:href="btz453f4"/></fig><fig id="btz453-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>False discovery rate (FDR) curves for differential expression methods on real datasets. Evaluating the performance different method by FDR curves using the (<bold>a</bold>) Tung et <italic>al.</italic>, (<bold>b</bold>) Soumillon <italic>et al.</italic>, (<bold>c</bold>) Savas <italic>et al.</italic> and (<bold>d</bold>) Chen <italic>et al.</italic> datasets. Bulk DEGs were considered as conditional positives. DECENT consistently showed low number of false discoveries at the same number of declared DEGs across all four datasets. Again, only the top one thousand DEGs were considered to focus on the region of interested. DE methods are denoted by different colors. Z-edgeR denotes ZINB-WaVE-adjusted edgeR. TASC requires spike-ins and was only evaluated using the Tung <italic>et al.</italic> data</p></caption><graphic xlink:href="btz453f5"/></fig><p>Among the other methods, MAST showed stable and generally good performance across datasets, while the performance of SCDE appeared to be dataset-specific, showing inadequacy for droplet-based experiments. The Monocle NB-based model based on observed UMI counts did not show satisfactory performance. The ZINB-WaVE adjustment of edgeR did not show noticeable improvements over standard edgeR for three out of four datasets. But it remarkably outperformed edgeR on the Chen <italic>et al.</italic> data, where both molecule counts and the cell numbers were high. To demonstrate the merit of performing DE analysis using a inferred pre-dropout rather than the observed expression, we selected a few genuine DEGs in the Tung <italic>et al.</italic> data that are detected by our method and not the others and compared their expression levels between the two cellular groups using either the observed counts or inferred pre-dropout counts. We discovered that the differential expression between two groups became more prominent in the pre-dropout counts (Supplementary Fig. S8).</p><p>ERCC spike-ins were available in Tung <italic>et al.</italic> data. We thus used capture rates estimated from spike-ins for the result shown. This dataset also enabled us to examine how specifying the ranked random capture rates impacts DE performance on real data. We performed DECENT DE analysis again using the ranked random capture rates specifying the range as half, the same and 1.5 times the range of the spike-in estimates. The results turned out to be in concordance with the simulation studies. Although optimal performance was achieved when capture rates estimated from spike-ins were used, there were only small decreases in performance when using the ranked random capture rates (Supplementary Fig. S9). This convincingly demonstrated the viability of using the spike-in capture rates for endogenous RNA and that DECENT&#x02019;s DE performance is also robust to misspecified capture rates.</p><p>For the Soumillon <italic>et al.</italic> data, the median of the log fold-change estimates deviates from zero when the standard MLEs were used to estimate the cell size factors <italic>s<sub>j</sub></italic>. This default size factor estimator effectively performs library size normalization on the inferred pre-dropout counts. The bias is greatly reduced when using the trimmed mean of <italic>M</italic> values method (<xref rid="btz453-B27" ref-type="bibr">Robinson and Oshlack, 2010</xref>) to estimate the size factors instead and the overall performance of DECENT was slightly improved (Supplementary Fig. S10). This suggests that different datasets may require different normalization strategies, and highlights the flexibility of our method with regards to normalization.</p><p>The benchmarking so far was based on two group comparisons. DECENT performs statistical tests under the under the well-established GLM framework and can readily accommodate more complex experimental designs. The Soumillon <italic>et al.</italic>&#x02019;s data are a time course experiment, with three time points involved in adipose stem cell differentiation. This allowed us to have a glance at how different DE methods perform on more complex UMI-based scRNA-seq experiments beyond two-group comparisons. We tested the hypothesis that expression of a gene is constant across the three time points. Except for SCDE, which is designed only for two group comparison, and TASC, which requires spike-ins, other methods were compared in this setting. The reference genuine DEGs across the three time points were also derived from the matching bulk experiments. DECENT again outperformed all other methods with an even more pronounced advantage (Supplementary Fig. S11).</p><p>In terms of controlling type I error, our in-silico investigation (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref> and Fig. S12) demonstrates that DECENT controls the type I error quite well.</p></sec></sec><sec><title>4 Discussion</title><p>We presented DECENT, a novel statistical method for performing DE analysis on UMI-based scRNA-seq data. UMI count data have provided us with an excellent opportunity to model the molecule capturing process. We found that the technical variation arising in this process can be characterized by a gene and cell-specific beta-binomial capture model. We were able to perform DE analysis on the inferred pre-dropout counts, and achieve good performance. Our model is usable either with or without spike-ins and is compatible with different normalization strategies. Also, we can draw on established statistical theory and use the model for analyzing data from experiments and studies more complex than two group comparisons. Used in a three group setting, the model gave promising results. Adding more cell-level covariates is straightforward (see Section 2) and is catered for in our software. External RNA spike-ins, such as the ERCC spike-ins (<xref rid="btz453-B12" ref-type="bibr">Jiang <italic>et al.</italic>, 2011</xref>) can give valuable insights into the technical variation in scRNA-seq data. They have been used in this way in some scRNA-seq methods (<xref rid="btz453-B11" ref-type="bibr">Jia <italic>et al.</italic>, 2017</xref>; <xref rid="btz453-B20" ref-type="bibr">Lun <italic>et al.</italic>, 2017</xref>). However, spiked-in molecules differ from endogenous transcripts in properties such as overall length, and length of the poly(A) tract, and in their technical variation such as capture rates (<xref rid="btz453-B32" ref-type="bibr">Svensson <italic>et al.</italic>, 2017</xref>). This raises the question of whether and how to use spike-ins in analyses like ours. When they are available we use them to estimate the capture rates in our model, that is, to center the beta-binomial distribution in each cell. During the development of our beta-binomial capture model, we found more variation in the data than would be found in a cell-specific binomial capture model. This extra variation is more likely to be due to spike-specific biases in capture rates rather than due to random noise (Supplementary Fig. S2). However, unlike cell-specific capture rates, the estimated spike-specific biases cannot be generalized to endogenous genes. Indeed we are unable to estimate the such gene-specific biases using only gene abundance, because it is not separable from a gene&#x02019;s mean expression. Such a separation would only be achievable if extra information was available. For example, it is plausible that capture rates would depend on features of the gene sequence such as GC-content and the length of the poly(A) tract. A more refined capture model might then be built by modeling the relationship between these gene-specific features and the gene-specific biases of capture rates. Fortunately, our method is flexible enough to permit the amount of over-dispersion in the capture process to differ between the spike-ins and endogenous genes to reflect any differences in the capture process of the two types of molecules. In this way we deal with the issue just mentioned.</p><p>Although multilevel models fitted with an ECM algorithm are intrinsically computationally intensive, DECENT has achieved acceptable speed with a series of acceleration approaches such as a gaussian quadrature approximation for large integration and parallelization of all the main steps. For instance, our simulated data with 500 cells and 3000 genes took 18&#x02009;min, while the largest dataset, Chen <italic>et al.</italic> with 6875 cells and 12&#x000a0;929 genes took &#x0223c;8&#x02009;h to finish on a 28-core XENON Radon Duo R1885 server node with Intel(R) Xeon(R) E5-2690 v4 CPUS @ 2.60&#x000a0;GHz. Some existing models for scRNA-seq allow tests beyond the comparison of means, such as comparisons of zero fractions, of biological variation or even the overall distributions (<xref rid="btz453-B17" ref-type="bibr">Korthauer <italic>et al.</italic>, 2016</xref>; <xref rid="btz453-B39" ref-type="bibr">Wang <italic>et al.</italic>, 2018</xref>; <xref rid="btz453-B40" ref-type="bibr">Wu <italic>et al.</italic>, 2018</xref>). But there remains a difficulty in assessing the type I error control and power of these tests due to lack of ground-truth. Single molecule FISH technology is under rapid development and is able to produce accurate measurements of distributions, biological variation and the zero fractions. As the amount of such data and number of genes profiled in this way increases, we should soon have the opportunity to assess these tests objectively.</p><p>While DECENT focuses on performing reliable statistical tests concerning gene mean abundance, it can be easily be extended to carry out other types of tests. For example, we can permit the zero-inflation parameter in the pre-dropout distribution to be a function of cell type. Then a linear logistic model can be used to test for biological differences in zero inflation. However, some alteration of the parameter estimation strategy may be needed to achieve valid testing results.</p><p>We have not incorporated any forms of Empirical Bayes (EB) in the estimation of DECENT model parameters. Several bulk RNA-seq methods for differential expression such as edgeR (<xref rid="btz453-B22" ref-type="bibr">McCarthy <italic>et al.</italic>, 2012</xref>) and DESeq2 (<xref rid="btz453-B18" ref-type="bibr">Love <italic>et al.</italic>, 2014</xref>) use EB shrinkage to stabilize estimates of gene-specific dispersion parameter. Among methods for scRNA-seq data, MAST (<xref rid="btz453-B5" ref-type="bibr">Finak <italic>et al.</italic>, 2015</xref>) uses EB to shrink the gene-specific variance parameter. Given that scRNA-seq data are very sparse, we certainly think there is potential benefit in using EB to improve DECENT&#x02019;s performance. One major challenge is there is no natural conjugate prior for the dispersion parameter of the ZINB or NB distribution that we use to model the count data. This is in contrast to MAST that uses Gaussian distribution to model the log(TPM)&#x000a0;+&#x000a0;1 data and therefore able to take advantage of the inverse Gamma conjugate prior for the variance parameter. DECENT also estimates the parameters associated with the unobserved rather than the observed data, which makes it less straightforward to introduce Bayes or EB variants. Our current thinking is that to implement EB within DECENT, we need to either use a form of variational Bayes (<xref rid="btz453-B61" ref-type="bibr">Beal, 2003</xref>) or something similar to the weighted likelihood method (<xref rid="btz453-B28" ref-type="bibr">Robinson and Smyth, 2007</xref>) that has been successfully used for bulk RNA-seq data.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>btz453_Supplementary_Data</label><media xlink:href="btz453_supplementary_data.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack id="ack1"><title>Acknowledgements</title><p>We would like to thank three anonymous reviewers for their constructive comments that have improved the quality of this article and Alexander Rhys Hayes for his assistance in preparing some of the Supplementary Figures.</p><sec><title>Funding</title><p>T.P.S. was awarded by Australian National Health and Medical Research Council Program Grant 105461.</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec></ack><ref-list id="ref1"><title>References</title><ref id="btz453-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Bacher</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Scnorm: robust normalization of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>584.</fpage><pub-id pub-id-type="pmid">28418000</pub-id></mixed-citation></ref><ref id="btz453-B61"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Beal</surname><given-names>M.J.</given-names></name></person-group> (<year>2003</year>) <chapter-title>Variational algorithms forapproximate bayesian inference. PhD Thesis, The Gatsby Computational Neuroscience Unit, University College London, London.</chapter-title></mixed-citation></ref><ref id="btz453-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Brennecke</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1093</fpage>&#x02013;<lpage>1095</lpage>.<pub-id pub-id-type="pmid">24056876</pub-id></mixed-citation></ref><ref id="btz453-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>W.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Umi-count modeling and differential expression analysis for single-cell RNA sequencing</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>70.</fpage><pub-id pub-id-type="pmid">29855333</pub-id></mixed-citation></ref><ref id="btz453-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Codeluppi</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) Spatial organization of the somatosensory cortex revealed by osmFISH. <italic>Nat. Methods</italic>, <volume>15</volume>, <fpage>932</fpage>&#x02013;<lpage>935</lpage>.</mixed-citation></ref><ref id="btz453-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Finak</surname><given-names>G.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Mast: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>278.</fpage><pub-id pub-id-type="pmid">26653891</pub-id></mixed-citation></ref><ref id="btz453-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Grun</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Validation of noise models for single-cell transcriptomics</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>637</fpage>&#x02013;<lpage>640</lpage>.<pub-id pub-id-type="pmid">24747814</pub-id></mixed-citation></ref><ref id="btz453-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Hashimshony</surname><given-names>T.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>Cel-seq: single-cell RNA-seq by multiplexed linear amplification</article-title>. <source>Cell Rep</source>., <volume>2</volume>, <fpage>666</fpage>&#x02013;<lpage>673</lpage>.<pub-id pub-id-type="pmid">22939981</pub-id></mixed-citation></ref><ref id="btz453-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Huang</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Saver: gene expression recovery for single-cell RNA sequencing</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>539</fpage>&#x02013;<lpage>542</lpage>.<pub-id pub-id-type="pmid">29941873</pub-id></mixed-citation></ref><ref id="btz453-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Islam</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>163</fpage>&#x02013;<lpage>166</lpage>.<pub-id pub-id-type="pmid">24363023</pub-id></mixed-citation></ref><ref id="btz453-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jia</surname><given-names>C.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Accounting for technical noise in differential expression analysis of single-cell RNA sequencing data</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>10978</fpage>&#x02013;<lpage>10988</lpage>.<pub-id pub-id-type="pmid">29036714</pub-id></mixed-citation></ref><ref id="btz453-B12"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jiang</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2011</year>) 
<article-title>Synthetic spike-in standards for RNA-seq experiments</article-title>. <source>Genome Res</source>., <volume>21</volume>, <fpage>1543</fpage>&#x02013;<lpage>1551</lpage>.<pub-id pub-id-type="pmid">21816910</pub-id></mixed-citation></ref><ref id="btz453-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kharchenko</surname><given-names>P.V.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Bayesian approach to single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>740</fpage>&#x02013;<lpage>742</lpage>.<pub-id pub-id-type="pmid">24836921</pub-id></mixed-citation></ref><ref id="btz453-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kiselev</surname><given-names>V.Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Sc3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>483.</fpage><pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation></ref><ref id="btz453-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Klein</surname><given-names>A.M.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1187</fpage>&#x02013;<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation></ref><ref id="btz453-B16"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kolodziejczyk</surname><given-names>A.A.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>The technology and biology of single-cell RNA sequencing</article-title>. <source>Mol. Cell</source>, <volume>58</volume>, <fpage>610</fpage>&#x02013;<lpage>620</lpage>.<pub-id pub-id-type="pmid">26000846</pub-id></mixed-citation></ref><ref id="btz453-B17"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Korthauer</surname><given-names>K.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>222.</fpage><pub-id pub-id-type="pmid">27782827</pub-id></mixed-citation></ref><ref id="btz453-B18"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Love</surname><given-names>M.I.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with deseq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550.</fpage><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation></ref><ref id="btz453-B19"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>A.T.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>75.</fpage><pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation></ref><ref id="btz453-B20"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>A.T.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) Assessing the reliability of spike-in normalization for analyses of single-cell RNA sequencing data. <italic>Genome Res.</italic>, <volume>27</volume>, <fpage>1795</fpage>&#x02013;<lpage>1806</lpage>.</mixed-citation></ref><ref id="btz453-B21"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Macosko</surname><given-names>E.Z.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>&#x02013;<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation></ref><ref id="btz453-B22"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>McCarthy</surname><given-names>D.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>Differential expression analysis of multifactor RNA-seq experiments with respect to biological variation</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>4288</fpage>&#x02013;<lpage>4297</lpage>.<pub-id pub-id-type="pmid">22287627</pub-id></mixed-citation></ref><ref id="btz453-B23"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Qiu</surname><given-names>X.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>979.</fpage><pub-id pub-id-type="pmid">28825705</pub-id></mixed-citation></ref><ref id="btz453-B24"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Raj</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>Imaging individual mRNA molecules using multiple singly labeled probes</article-title>. <source>Nat. Methods</source>, <volume>5</volume>, <fpage>877.</fpage><pub-id pub-id-type="pmid">18806792</pub-id></mixed-citation></ref><ref id="btz453-B25"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ramskold</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>Full-length mRNA-seq from single-cell levels of RNA and individual circulating tumor cells</article-title>. <source>Nat. Biotechnol</source>., <volume>30</volume>, <fpage>777</fpage>&#x02013;<lpage>782</lpage>.<pub-id pub-id-type="pmid">22820318</pub-id></mixed-citation></ref><ref id="btz453-B26"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Risso</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>A general and flexible method for signal extraction from single-cell RNA-seq data</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>284.</fpage><pub-id pub-id-type="pmid">29348443</pub-id></mixed-citation></ref><ref id="btz453-B27"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name>, <name name-style="western"><surname>Oshlack</surname><given-names>A.</given-names></name></person-group> (<year>2010</year>) 
<article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biol</source>., <volume>11</volume>, <fpage>R25.</fpage><pub-id pub-id-type="pmid">20196867</pub-id></mixed-citation></ref><ref id="btz453-B28"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name>, <name name-style="western"><surname>Smyth</surname><given-names>G.K.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>2881</fpage>&#x02013;<lpage>2887</lpage>.<pub-id pub-id-type="pmid">17881408</pub-id></mixed-citation></ref><ref id="btz453-B29"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Savas</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Single-cell profiling of breast cancer t cells reveals a tissue-resident memory subset associated with improved prognosis</article-title>. <source>Nat. Med</source>., <volume>24</volume>, <fpage>986</fpage>&#x02013;<lpage>993</lpage>.<pub-id pub-id-type="pmid">29942092</pub-id></mixed-citation></ref><ref id="btz453-B30"><mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Soumillon</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) Characterization of directed differentiation by high-throughput single-cell RNA-seq. doi: 10.1101/003236.</mixed-citation></ref><ref id="btz453-B31"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Sun</surname><given-names>Z.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Single-cell RNA sequencing reveals gene expression signatures of breast cancer-associated endothelial cells</article-title>. <source>Oncotarget</source>, <volume>9</volume>, <fpage>10945</fpage>&#x02013;<lpage>10961</lpage>.<pub-id pub-id-type="pmid">29541388</pub-id></mixed-citation></ref><ref id="btz453-B32"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Svensson</surname><given-names>V.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>381</fpage>&#x02013;<lpage>387</lpage>.<pub-id pub-id-type="pmid">28263961</pub-id></mixed-citation></ref><ref id="btz453-B33"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Trapnell</surname><given-names>C.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381.</fpage><pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation></ref><ref id="btz453-B34"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tung</surname><given-names>P.-Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Batch effects and the effective design of single-cell gene expression studies</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>39921</fpage>.<pub-id pub-id-type="pmid">28045081</pub-id></mixed-citation></ref><ref id="btz453-B35"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Van den Berge</surname><given-names>K.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Observation weights unlock bulk RNA-seq tools for zero inflation and single-cell applications</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>24.</fpage><pub-id pub-id-type="pmid">29478411</pub-id></mixed-citation></ref><ref id="btz453-B36"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>van Dijk</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Recovering gene interactions from single-cell data using data diffusion</article-title>. <source>Cell</source>, <volume>173</volume>, <fpage>716</fpage>&#x02013;<lpage>729.e27</lpage>.</mixed-citation></ref><ref id="btz453-B37"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Vieth</surname><given-names>B.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>powsimr: power analysis for bulk and single cell RNA-seq experiments</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>3486</fpage>&#x02013;<lpage>3488</lpage>.<pub-id pub-id-type="pmid">29036287</pub-id></mixed-citation></ref><ref id="btz453-B38"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wagner</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>1145</fpage>&#x02013;<lpage>1160</lpage>.<pub-id pub-id-type="pmid">27824854</pub-id></mixed-citation></ref><ref id="btz453-B39"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Gene expression distribution deconvolution in single-cell RNA sequencing</article-title>. <source>Proc. Natl. Acad. Sci</source>., <volume>115</volume>, <fpage>E6437</fpage>&#x02013;<lpage>E6446</lpage>.<pub-id pub-id-type="pmid">29946020</pub-id></mixed-citation></ref><ref id="btz453-B40"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>Z.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) Two-phase differential expression analysis for single cell RNA-seq. <italic>Bioinformatics</italic>, <volume>34</volume>, <fpage>3340</fpage>&#x02013;<lpage>3348</lpage>.</mixed-citation></ref><ref id="btz453-B41"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zeisel</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>347</volume>, <fpage>1138</fpage>&#x02013;<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation></ref><ref id="btz453-B42"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zhao</surname><given-names>X.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Single-cell RNA-seq reveals a distinct transcriptome signature of aneuploid hematopoietic cells</article-title>. <source>Blood</source>, <volume>130</volume>, <fpage>2762</fpage>&#x02013;<lpage>2773</lpage>.<pub-id pub-id-type="pmid">29030335</pub-id></mixed-citation></ref><ref id="btz453-B43"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>G.X.Y.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14049.</fpage><pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation></ref><ref id="btz453-B44"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ziegenhain</surname><given-names>C.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>. <source>Mol. Cell</source>, <volume>65</volume>, <fpage>631</fpage>&#x02013;<lpage>643.e4</lpage>.<pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation></ref></ref-list></back></article>