<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="brief-report"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">31368484</article-id><article-id pub-id-type="pmc">6954646</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btz597</article-id><article-id pub-id-type="publisher-id">btz597</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group subj-group-type="category-toc-heading"><subject>Sequence Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>Sequence tube maps: making graph genomes intuitive to commuters</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Beyer</surname><given-names>Wolfgang</given-names></name><xref ref-type="aff" rid="btz597-aff1">1</xref><xref ref-type="aff" rid="btz597-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Novak</surname><given-names>Adam M</given-names></name><xref ref-type="aff" rid="btz597-aff1">1</xref><xref ref-type="aff" rid="btz597-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Hickey</surname><given-names>Glenn</given-names></name><xref ref-type="aff" rid="btz597-aff1">1</xref><xref ref-type="aff" rid="btz597-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Chan</surname><given-names>Jeffrey</given-names></name><xref ref-type="aff" rid="btz597-aff1">1</xref><xref ref-type="aff" rid="btz597-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Tan</surname><given-names>Vanessa</given-names></name><xref ref-type="aff" rid="btz597-aff1">1</xref><xref ref-type="aff" rid="btz597-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Paten</surname><given-names>Benedict</given-names></name><xref ref-type="aff" rid="btz597-aff1">1</xref><xref ref-type="aff" rid="btz597-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Zerbino</surname><given-names>Daniel R</given-names></name><xref ref-type="corresp" rid="btz597-cor1"/><xref ref-type="aff" rid="btz597-aff3">3</xref><!--<email>zerbino@ebi.ac.uk</email>--></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Valencia</surname><given-names>Alfonso</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="btz597-aff1"><label>1</label>
<institution>UC Santa Cruz Genomics Institute</institution>
</aff><aff id="btz597-aff2"><label>2</label>
<institution>Department of Biomolecular Engineering, University of California</institution>, Santa Cruz, CA, <country country="US">USA</country></aff><aff id="btz597-aff3"><label>3</label>
<institution>European Molecular Biology Laboratory, European Bioinformatics Institute</institution>, Wellcome Genome Campus, Hinxton, Cambridge, <country country="GB">UK</country></aff><author-notes><corresp id="btz597-cor1">To whom correspondence should be addressed. E-mail: <email>zerbino@ebi.ac.uk</email></corresp></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-08-01"><day>01</day><month>8</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>01</day><month>8</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>24</issue><fpage>5318</fpage><lpage>5320</lpage><history><date date-type="received"><day>25</day><month>3</month><year>2019</year></date><date date-type="rev-recd"><day>27</day><month>6</month><year>2019</year></date><date date-type="accepted"><day>26</day><month>7</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="btz597.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Compared to traditional haploid reference genomes, graph genomes are an efficient and compact data structure for storing multiple genomic sequences, for storing polymorphisms or for mapping sequencing reads with greater sensitivity. Further, graphs are well-studied computer science objects that can be efficiently analyzed. However, their adoption in genomic research is slow, in part because of the cognitive difficulty in interpreting graphs.</p></sec><sec id="s2"><title>Results</title><p>We present an intuitive graphical representation for graph genomes that re-uses well-honed techniques developed to display public transport networks, and demonstrate it as a web tool.</p></sec><sec id="s3"><title>Availability and implementation</title><p>
<bold>Code:</bold>
<ext-link ext-link-type="uri" xlink:href="https://github.com/vgteam/sequenceTubeMap">https://github.com/vgteam/sequenceTubeMap</ext-link>.</p></sec><sec id="s5"><title>Demonstration</title><p>
<ext-link ext-link-type="uri" xlink:href="https://vgteam.github.io/sequenceTubeMap/">https://vgteam.github.io/sequenceTubeMap/</ext-link>.</p></sec><sec id="s6"><title>Supplementary information</title><p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Institutes of Health</named-content><named-content content-type="funder-identifier">10.13039/100000002</named-content></funding-source><award-id>1U01HL137183-01</award-id><award-id>5U54HG007990</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">W. M. Keck Foundation</named-content><named-content content-type="funder-identifier">10.13039/100000888</named-content></funding-source><award-id>DT06172015</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Wellcome Trust</named-content><named-content content-type="funder-identifier">10.13039/100010269</named-content></funding-source><award-id>WT201535/Z/16/Z</award-id><award-id>WT108749/Z/15/Z</award-id></award-group></funding-group><counts><page-count count="3"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Graph structures have been abundantly used for a wide array of genome sequence analyses, such as <italic>de novo</italic> assembly (<xref rid="btz597-B4" ref-type="bibr">Medvedev <italic>et al.</italic>, 2009</xref>) or whole genome alignment and variation analysis (<xref rid="btz597-B6" ref-type="bibr">Paten <italic>et al.</italic>, 2017</xref>), because they offer a flexible and compact way of representing sequences that differ slightly, whether for biological reasons (e.g. polymorphisms) or technical ones (e.g. sequencing errors). In particular, graph genomes allow sequence mappers to take structural variation and polymorphism into account and reduce bias in variant calling (<xref rid="btz597-B6" ref-type="bibr">Paten <italic>et al.</italic>, 2017</xref>).</p><p>Software libraries such as <italic>vg</italic> (<xref rid="btz597-B2" ref-type="bibr">Garrison <italic>et al.</italic>, 2018</xref>) can efficiently store DNA sequences and compute or extract alignments between them. Its Graph Alignment Map file format can store the alignment of short sequencing reads to a graph. We set out to develop an intuitive display to examine the alignments of sequencing reads to a graph genome, as produced by <italic>vg&#x02019;</italic>s mapper. To our knowledge, there exists no solution to view both structural variation and sequence alignments.</p><p>From a technical point of view, genomic graphs are generally isomorphic to a specific subtype of graph called bi-directed graphs (<xref rid="btz597-B4" ref-type="bibr">Medvedev <italic>et al.</italic>, 2009</xref>). In these graphs, all the edges connected to a node are clearly divided into two sets, often represented as incoming and outgoing edges or else as edges connected to one of two ends of the node. The node thus conceptually has two ends, like the DNA fragments it represents. If entered through one end, a node must be exited through the other. A node thus corresponds to a sequence of nucleotides when entered through one end, and its reverse complement when entered through the other. Each edge is characterized by its direction through either node it connects to, hence is bi-directed. Genomic sequences are thus represented as sequences of nodes connected end to end.</p><p>Consequently, many tools of graph theory do not apply perfectly to bi-directed genomic graphs. Current graph genome visualization tools (<xref rid="btz597-B5" ref-type="bibr">Nielsen <italic>et al.</italic>, 2009</xref>; <xref rid="btz597-B8" ref-type="bibr">Wick <italic>et al.</italic>, 2015</xref>) generally represent DNA fragments as edges and their connections are collapsed into isotropic nodes. This produces layouts where the orientation of edges along meaningful sequences such as haplotypes are not coordinated, creating paths that zig&#x02013;zag randomly across the graph&#x02019;s diagram.</p><p>We propose here a graph layout approach for genomic graphs that focuses on maximizing the linearity of selected genomic paths. It is heavily inspired by London&#x02019;s iconic Tube Map, as designed by Harry Beck in 1931, which was itself inspired from circuit diagrams (<xref rid="btz597-B1" ref-type="bibr">Garland, 1994</xref>). There exist algorithms to automatically draw such maps (<xref rid="btz597-B9" ref-type="bibr">Wolff, 2007</xref>), however, for speed and interactivity we opted for heuristics in this implementation.</p></sec><sec><title>2 Materials and methods</title><p>The atomic elements of our representation are bi-directed nodes, drawn as rounded rectangles. The left and right edges of the rectangles are the ends of the nodes, and the direction of an edge incident on a node is thus represented by which side it is attached to. At the top of the rectangle is the sequence which corresponds to traversing the node left to right. Through these nodes we draw out representative paths as colored lines, which can correspond to haplotypes or sequencing reads. A given path can traverse a node an arbitrary number of times, thus representing deletions or duplications. Every time it traverses a node, it can go in one direction or the other, thus representing inversions. The example in <xref ref-type="fig" rid="btz597-F1">Figure&#x000a0;1</xref> illustrates how all types of structural variants can be represented. Optionally, it is possible to mark on the paths the bases where they differ from the reference. <xref ref-type="fig" rid="btz597-F2">Figure&#x000a0;2</xref> illustrates the usefulness of Tube Maps when displaying short reads mapped to a graph genome.
</p><fig id="btz597-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Two genomic sequences represented with a tube map</p></caption><graphic xlink:href="btz597f1"/></fig><fig id="btz597-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Representing sequencing reads on a graph. The sequence of the reads is only represented on the bases where they differ from the reference</p></caption><graphic xlink:href="btz597f2"/></fig><p>The graph layout algorithm is heuristic and tries to arrange the graph horizontally with the sequence paths running from left to right (or from right to left). In a first pass of the algorithm, all nodes are arranged into horizontal slots. The algorithm walks along one sequence path after another, trying to arrange the unassigned nodes it passes through from left to right. There can be multiple nodes in a single slot, which means these nodes have the same horizontal but different vertical positions. In the second pass, the algorithm passes over each horizontal slot from left to right and lays out its content (the nodes and all sequence paths traversing this slot, whether within a node or not) vertically. This step is greedy, minimizing the sum of the absolute differences of each sequence path&#x02019;s vertical position compared to the same path&#x02019;s position in the previous slot.</p><p>Our implementation is enhanced by interactive features. For example, hovering above one of the sequences highlights it across its entire length, which can make it easier to follow in the presence of many other sequences. Double clicking on it turns it into the reference sequence for the graph, which is instantly re-arranged (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p></sec><sec><title>3 Results</title><p>We implemented SequenceTubeMap, a JavaScript module that displays <italic>vg</italic> files. To visualize a specific <italic>vg</italic> file, it is possible to launch a server which provides the data to SequenceTubeMap. The same visual representation could possibly be adapted to other graph genome formats, provided they can be queried through an API.</p><p>We have successfully used SequenceTubeMap to visualize a graph of the 2504 haplotypes of the 1000 Genomes Project (<xref rid="btz597-B10" ref-type="bibr">The 1000 Genomes Project Consortium, 2015</xref>), as well as reads mapped against it. We provide a tutorial along with the SequenceTubeMap software that describes how user-provided data can be visualized with the tool; sufficiently small files can be uploaded directly to our demonstration instance.</p><p>In practice, the ability to readily visualize alignments on a graph genome has proven invaluable in shortening the de-bugging cycle in our work on the <italic>vg</italic> mapping tool. Although the view can get progressively cluttered in the presence of many re-arrangements, it is particularly useful in examining alignment details at junction points or around small structural variants.</p></sec><sec><title>4 Conclusion</title><p>There is a growing need for genomic tools that can handle the complexities of polymorphism and structural variation. This in turn will require researchers to adapt their work to this enriched context, for example to examine alignments and variant calls in polymorphic regions. Intuitive visualization tools such as the sequence tube maps will help them explore and become familiar with graph genomes.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>btz597_Supplementary_Material</label><media xlink:href="btz597_supplementary_material.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack id="ack1"><title>Acknowledgement</title><p>The authors thank Toshiyuki Yokoyama for fixes to the code.</p><sec><title>Funding</title><p>This work was supported by the National Institutes of Health [1U01HL137183-01 and 5U54HG007990] (to W.B., A.N., G.H., J.C. and B.P.) and the W. M. Keck Foundation [DT06172015]. W.B. was also funded by the Google Summer of Code programme. D.Z. was supported by the Wellcome Trust (WT201535/Z/16/Z, WT108749/Z/15/Z) and the the European Molecular Biology Laboratory.</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec></ack><ref-list id="ref1"><title>References</title><ref id="btz597-B1"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Garland</surname><given-names>K.</given-names></name></person-group> (<year>1994</year>) <source>Mr. Beck&#x02019;s Underground Map</source>. 
<publisher-name>Capital Transport Publishing</publisher-name>, 
<publisher-loc>Harrow Weald, UK</publisher-loc>. </mixed-citation></ref><ref id="btz597-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Garrison</surname><given-names>E.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Variation graph toolkit improves read mapping by representing genetic variation in the reference</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>875</fpage>&#x02013;<lpage>879</lpage>.<pub-id pub-id-type="pmid">30125266</pub-id></mixed-citation></ref><ref id="btz597-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Medvedev</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>Computability of models for sequence assembly</article-title>. <source>J. Comput. Biol</source>., <volume>16</volume>, <fpage>1101</fpage>&#x02013;<lpage>1116</lpage>.<pub-id pub-id-type="pmid">19645596</pub-id></mixed-citation></ref><ref id="btz597-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Nielsen</surname><given-names>C.B.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>ABySS-explorer: visualizing genome sequence assemblies</article-title>. <source>IEEE Trans. Vis. Comp. Graph</source>, <volume>15</volume>, <fpage>881</fpage>&#x02013;<lpage>888</lpage>.</mixed-citation></ref><ref id="btz597-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Paten</surname><given-names>B.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Genome graphs and the evolution of genome inference</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>665</fpage>&#x02013;<lpage>676</lpage>.<pub-id pub-id-type="pmid">28360232</pub-id></mixed-citation></ref><ref id="btz597-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wick</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Bandage: interactive visualization of <italic>de novo</italic> genome assemblies</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3350</fpage>&#x02013;<lpage>3352</lpage>.<pub-id pub-id-type="pmid">26099265</pub-id></mixed-citation></ref><ref id="btz597-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wolff</surname><given-names>A.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Drawing subway maps, a survey</article-title>. <source>Informatik Forsch. Entw</source>., <volume>22</volume>, <fpage>23</fpage>&#x02013;<lpage>44</lpage>.</mixed-citation></ref><ref id="btz597-B10"><mixed-citation publication-type="journal">The 1000 Genomes Project Consortium. (<year>2015</year>) 
<article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>, <fpage>68</fpage>&#x02013;<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation></ref></ref-list></back></article>