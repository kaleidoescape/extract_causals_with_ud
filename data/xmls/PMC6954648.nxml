<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="brief-report"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">31350555</article-id><article-id pub-id-type="pmc">6954648</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btz582</article-id><article-id pub-id-type="publisher-id">btz582</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group subj-group-type="category-toc-heading"><subject>Genetics and Population Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>amplimap: a versatile tool to process and analyze targeted NGS data</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-5292-4510</contrib-id><name><surname>Koelling</surname><given-names>Nils</given-names></name><xref ref-type="corresp" rid="btz582-cor1"/><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref><!--<email>nils.koelling@ndcls.ox.ac.uk</email>--></contrib><contrib contrib-type="author"><name><surname>Bernkopf</surname><given-names>Marie</given-names></name><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Calpena</surname><given-names>Eduardo</given-names></name><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7135-4824</contrib-id><name><surname>Maher</surname><given-names>Geoffrey J</given-names></name><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Miller</surname><given-names>Kerry A</given-names></name><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ralph</surname><given-names>Hannah K</given-names></name><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Goriely</surname><given-names>Anne</given-names></name><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref><xref ref-type="author-notes" rid="btz582-FM1"/></contrib><contrib contrib-type="author"><name><surname>Wilkie</surname><given-names>Andrew O M</given-names></name><xref ref-type="aff" rid="btz582-aff1">1</xref><xref ref-type="aff" rid="btz582-aff2">2</xref><xref ref-type="author-notes" rid="btz582-FM1"/></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Valencia</surname><given-names>Alfonso</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="btz582-aff1"><label>1</label>
<institution>Clinical Genetics Group, MRC Weatherall Institute of Molecular Medicine</institution>
</aff><aff id="btz582-aff2"><label>2</label>
<institution>Nuffield Division of Clinical Laboratory Sciences, Radcliffe Department of Medicine</institution>, University of Oxford, Oxford, <country country="GB">UK</country></aff><author-notes><corresp id="btz582-cor1">To whom correspondence should be addressed. E-mail: <email>nils.koelling@ndcls.ox.ac.uk</email></corresp><fn id="btz582-FM1"><label><sup>&#x02020;</sup></label><p>The authors wish it to be known that, in their opinion, Anne Goriely and Andrew O. M. Wilkie authors should be regarded as Joint Last Authors.</p></fn></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-07-26"><day>26</day><month>7</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>26</day><month>7</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>24</issue><fpage>5349</fpage><lpage>5350</lpage><history><date date-type="received"><day>04</day><month>1</month><year>2019</year></date><date date-type="rev-recd"><day>01</day><month>6</month><year>2019</year></date><date date-type="accepted"><day>22</day><month>7</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="btz582.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Summary</title><p>amplimap is a command-line tool to automate the processing and analysis of data from targeted next-generation sequencing experiments with PCR-based amplicons or capture-based enrichment systems. From raw sequencing reads, amplimap generates output such as read alignments, annotated variant calls, target coverage statistics and variant allele counts and frequencies for each target base pair. In addition to its focus on user-friendliness and reproducibility, amplimap supports advanced features such as consensus base calling for read families based on unique molecular identifiers and filtering false positive variant calls caused by amplification of off-target loci.</p></sec><sec id="s2"><title>Availability and implementation</title><p>amplimap is available as a free Python package under the open-source Apache 2.0 License. Documentation, source code and installation instructions are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/koelling/amplimap">https://github.com/koelling/amplimap</ext-link>.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Wellcome Trust</named-content><named-content content-type="funder-identifier">10.13039/100010269</named-content></funding-source><award-id>102731</award-id><award-id>102731</award-id><award-id>105361</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Institute for Health Research (NIHR)</named-content></funding-source></award-group></funding-group><counts><page-count count="2"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Targeted next-generation sequencing (NGS), for example from PCR-generated amplicons or capture-based methods, is widely used for screening of candidate disease genes in patient cohorts (<xref rid="btz582-B4" ref-type="bibr">Fenwick <italic>et al.</italic>, 2016</xref>) or for quantification of variant allele frequencies (VAFs) to detect allele-specific expression or mosaic mutations (<xref rid="btz582-B2" ref-type="bibr">Bernkopf <italic>et al.</italic>, 2017</xref>; <xref rid="btz582-B8" ref-type="bibr">Reijnders <italic>et al.</italic>, 2018</xref>).</p><p>Recently, targeted NGS techniques have also been extended to redundantly sequence the same original molecule of DNA multiple times to achieve very low error rates (<xref rid="btz582-B9" ref-type="bibr">Salk <italic>et al.</italic>, 2018</xref>). This enables the detection of somatic, sub-clonal mutations from cancer samples or mosaicism down to low levels (<xref rid="btz582-B1" ref-type="bibr">Acuna-Hidalgo <italic>et al.</italic>, 2017</xref>; <xref rid="btz582-B7" ref-type="bibr">Maher <italic>et al.</italic>, 2018</xref>). These high-fidelity protocols typically rely on the inclusion of unique molecular identifier (UMI) sequences, for example with single-molecule molecular inversion probes (smMIPs, <xref rid="btz582-B5" ref-type="bibr">Hiatt <italic>et al.</italic>, 2013</xref>).</p><p>However, significant computational work needs to be carried out to translate the raw sequencing reads generated by these protocols into interpretable genomic data, such as variant calls or VAFs. In practice, the processing and analysis of targeted NGS data often involves custom scripts, written specifically for the experimental design and dataset. Thus, each new analysis requires a significant amount of hands-on work from computational specialists and may be difficult to reproduce or repeat later.</p><p>Furthermore, a common challenge is the unintended amplification of highly homologous loci, such as pseudogenes (<xref rid="btz582-B3" ref-type="bibr">Claes and De Leeneer, 2014</xref>). These loci may be amplified when primers inadvertently hybridize to highly homologous regions, creating chimeric reads that may lead to false variant calls (<xref ref-type="fig" rid="btz582-F1">Fig.&#x000a0;1a</xref>). Currently, such false positives are often only identified through manual comparison to pseudogene sequences.
</p><fig id="btz582-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Illustration of custom features in amplimap. (<bold>a</bold>) False positive variants due to off-target events: Amplification of pseudogenes may generate chimeric reads that match the target gene better than the pseudogene, resulting in misalignment (left alignment, shown in green/dark grey) and pseudogene-specific bases being called as variants. (<bold>b</bold>) Trimming primers before alignment helps detect chimeric reads generated by off-target events: The trimmed read aligns to the pseudogene (right alignment, shown in green/dark grey), avoiding a false positive variant call. (<bold>c</bold>) Consensus calls are determined within each read family and filtered with user-defined stringency thresholds, resulting in more accurate allele counts. (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p></caption><graphic xlink:href="btz582f1"/></fig><p>Here, we describe amplimap, a versatile tool that solves these challenges and enables the efficient processing and analysis of data from targeted NGS experiments.</p></sec><sec><title>2 Features and implementation</title><p>amplimap was developed in close collaboration with experimental scientists to ensure maximum user-friendliness and wide applicability. Processing a dataset only requires running a single command. Analyses can be customized in a variety of ways to fit the exact experiment performed. Input files are automatically checked for problems and tutorials are provided to act as a blueprint for common experiments. Results are provided as tables in CSV format, which can easily be loaded into Python, R or Excel for further analysis.</p><p>The main component of amplimap is the <monospace>amplimap</monospace> command-line executable, which has been tested with Python 3.5+ on current versions of Linux, MacOS and Windows (through the Windows Subsystem for Linux). Internally, amplimap uses the Snakemake work flow management package (<xref rid="btz582-B6" ref-type="bibr">K&#x000f6;ster and Rahmann, 2012</xref>) to automate the efficient execution of external software as well as custom code. An overview of the pipeline and its input and output files is available from <ext-link ext-link-type="uri" xlink:href="https://amplimap.readthedocs.io">https://amplimap.readthedocs.io</ext-link>.</p><sec><title>2.1 Annotated variant table and target coverage data</title><p>amplimap can create an aggregate table of all germline variants in all samples, including annotation such as the affected gene, the predicted deleteriousness of the variant and its frequency in reference populations. Additional target coverage tables give an overview of how thoroughly each target was sequenced in each sample.</p></sec><sec><title>2.2 Primer trimming and detection of off-target events</title><p>Primer sequences can be detected and trimmed by amplimap before alignment. This helps remove false positive variant calls caused by off-target amplification (<xref ref-type="fig" rid="btz582-F1">Fig.&#x000a0;1b</xref>). The locations of off-target alignments are reported to allow further investigation. In addition, primer trimming also corrects skewed VAFs in regions where primers overlap another amplicon.</p></sec><sec><title>2.3 Read family consensus calls</title><p>To enable high-fidelity VAF quantification, amplimap can group reads based on identical UMIs (e.g. from smMIPs). When calculating allele counts and fractions, amplimap uses these read families instead of the individual reads to obtain more accurate, error-corrected consensus calls (<xref ref-type="fig" rid="btz582-F1">Fig.&#x000a0;1c</xref>). The stringency of the consensus calls can be adjusted by specifying the minimum number of reads required to form a read family as well as the minimum fraction of reads supporting a consensus call. amplimap also calculates metrics such as the number of reads per family to provide quality control information and support future experimental design.</p></sec><sec><title>2.4 Tutorials</title><p>Tutorials are available from <ext-link ext-link-type="uri" xlink:href="https://amplimap.readthedocs.io">https://amplimap.readthedocs.io</ext-link> showing how to apply amplimap in three different contexts: variant calling in a patient panel, quantification of allele-specific expression and the identification of low-frequency somatic mutations with UMI-tagged smMIPs.</p></sec></sec></body><back><ack id="ack1"><title>Acknowledgements</title><p>The authors would like to thank Ewan MacMahon and the members of the Wilkie and Goriely groups for their help with development and testing.</p><sec><title>Funding</title><p>This work was supported by the Wellcome Trust [grant number 102731 to A.O.M.W.]. This work was supported by the Wellcome [grant numbers 102731 to A.O.M.W. and 105361 to H.K.R.], National Institute for Health Research (NIHR) Oxford Biomedical Research Centre (A.G. and A.O.M.W.) and Newlife (A.G. and A.O.M.W.).</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec></ack><ref-list id="ref1"><title>References</title><ref id="btz582-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Acuna-Hidalgo</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Ultra-sensitive sequencing identifies high prevalence of clonal hematopoiesis-associated mutations throughout adult life</article-title>. <source>Am. J. Hum. Genet</source>., <volume>101</volume>, <fpage>50</fpage>&#x02013;<lpage>64</lpage>.<pub-id pub-id-type="pmid">28669404</pub-id></mixed-citation></ref><ref id="btz582-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Bernkopf</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Quantification of transmission risk in a male patient with a FLNB mosaic mutation causing Larsen syndrome: implications for genetic counseling in postzygotic mosaicism cases</article-title>. <source>Hum. Mutat</source>., <volume>38</volume>, <fpage>1360</fpage>&#x02013;<lpage>1364</lpage>.<pub-id pub-id-type="pmid">28639312</pub-id></mixed-citation></ref><ref id="btz582-B3"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Claes</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>De Leeneer</surname><given-names>K.</given-names></name></person-group> (<year>2014</year>) <chapter-title>Dealing with pseudogenes in molecular diagnostics in the next-generation sequencing era</chapter-title> In: <source>Methods in Molecular Biology</source>. Vol. <volume>1167</volume>
<publisher-name>Humana Press</publisher-name>, 
<publisher-loc>New York, NY</publisher-loc>, pp. <fpage>303</fpage>&#x02013;<lpage>315</lpage>.<pub-id pub-id-type="pmid">24823787</pub-id></mixed-citation></ref><ref id="btz582-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Fenwick</surname><given-names>A.L.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Mutations in CDC45, encoding an essential component of the pre-initiation complex, cause Meier-Gorlin syndrome and craniosynostosis</article-title>. <source>Am. J. Hum. Genet</source>., <volume>99</volume>, <fpage>125</fpage>&#x02013;<lpage>138</lpage>.<pub-id pub-id-type="pmid">27374770</pub-id></mixed-citation></ref><ref id="btz582-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Hiatt</surname><given-names>J.B.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>Single molecule molecular inversion probes for targeted, high-accuracy detection of low-frequency variation</article-title>. <source>Genome Res</source>., <volume>23</volume>, <fpage>843</fpage>&#x02013;<lpage>854</lpage>.<pub-id pub-id-type="pmid">23382536</pub-id></mixed-citation></ref><ref id="btz582-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>K&#x000f6;ster</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Rahmann</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Snakemake-a scalable bioinformatics workflow engine</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>2520</fpage>&#x02013;<lpage>2522</lpage>.<pub-id pub-id-type="pmid">22908215</pub-id></mixed-citation></ref><ref id="btz582-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Maher</surname><given-names>G.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Selfish mutations dysregulating RAS-MAPK signaling are pervasive in aged human testes</article-title>. <source>Genome Res</source>., <volume>28</volume>, <fpage>1779</fpage>&#x02013;<lpage>1790</lpage>.<pub-id pub-id-type="pmid">30355600</pub-id></mixed-citation></ref><ref id="btz582-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Reijnders</surname><given-names>M.R.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>De Novo and inherited loss-of-function variants in TLK2: clinical and genotype-phenotype evaluation of a distinct neurodevelopmental disorder</article-title>. <source>Am. J. Hum. Genet</source>., <volume>102</volume>, <fpage>1195</fpage>&#x02013;<lpage>1203</lpage>.<pub-id pub-id-type="pmid">29861108</pub-id></mixed-citation></ref><ref id="btz582-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Salk</surname><given-names>J.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Enhancing the accuracy of next-generation sequencing for detecting rare and subclonal mutations</article-title>. <source>Nat. Rev. Genet</source>., <volume>19</volume>, <fpage>269</fpage>&#x02013;<lpage>285</lpage>.<pub-id pub-id-type="pmid">29576615</pub-id></mixed-citation></ref></ref-list></back></article>