<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="brief-report"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">31373345</article-id><article-id pub-id-type="pmc">6954654</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btz601</article-id><article-id pub-id-type="publisher-id">btz601</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Notes</subject><subj-group subj-group-type="category-toc-heading"><subject>Genome Analysis</subject></subj-group></subj-group></article-categories><title-group><article-title>scRNABatchQC: multi-samples quality control for single cell RNA-seq data</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Liu</surname><given-names>Qi</given-names></name><xref ref-type="aff" rid="btz601-aff1">1</xref><xref ref-type="aff" rid="btz601-aff2">2</xref><xref ref-type="author-notes" rid="btz601-FM1"/></contrib><contrib contrib-type="author"><name><surname>Sheng</surname><given-names>Quanhu</given-names></name><xref ref-type="aff" rid="btz601-aff1">1</xref><xref ref-type="aff" rid="btz601-aff2">2</xref><xref ref-type="author-notes" rid="btz601-FM1"/></contrib><contrib contrib-type="author"><name><surname>Ping</surname><given-names>Jie</given-names></name><xref ref-type="aff" rid="btz601-aff1">1</xref><xref ref-type="aff" rid="btz601-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Ramirez</surname><given-names>Marisol Adelina</given-names></name><xref ref-type="aff" rid="btz601-aff1">1</xref><xref ref-type="aff" rid="btz601-aff2">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8438-0319</contrib-id><name><surname>Lau</surname><given-names>Ken S</given-names></name><xref ref-type="aff" rid="btz601-aff2">2</xref><xref ref-type="aff" rid="btz601-aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Coffey</surname><given-names>Robert J</given-names></name><xref ref-type="aff" rid="btz601-aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Shyr</surname><given-names>Yu</given-names></name><xref ref-type="aff" rid="btz601-aff1">1</xref><xref ref-type="aff" rid="btz601-aff2">2</xref><xref ref-type="corresp" rid="btz601-cor1"/><!--<email>yu.shyr@vanderbilt.edu</email>--></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Robinson</surname><given-names>Mark</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="btz601-aff1"><label>1</label>
<institution>Department of Biostatistics, Vanderbilt University School of Medicine</institution>, Nashville, TN, <country country="US">USA</country></aff><aff id="btz601-aff2"><label>2</label>
<institution>Center for Quantitative Sciences, Vanderbilt University School of Medicine</institution>, Nashville, TN, <country country="US">USA</country></aff><aff id="btz601-aff3"><label>3</label>
<institution>Department of Cell and Developmental Biology, Vanderbilt University School of Medicine</institution>, Nashville, TN, <country country="US">USA</country></aff><author-notes><fn id="btz601-FM1"><p>The authors wish it to be known that, in their opinion, Qi Liu and Quanhu Sheng authors should be regarded as Joint First Authors.</p></fn><corresp id="btz601-cor1">To whom correspondence should be addressed. E-mail: <email>yu.shyr@vanderbilt.edu</email></corresp></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-08-02"><day>02</day><month>8</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>02</day><month>8</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>24</issue><fpage>5306</fpage><lpage>5308</lpage><history><date date-type="received"><day>06</day><month>3</month><year>2019</year></date><date date-type="rev-recd"><day>26</day><month>7</month><year>2019</year></date><date date-type="accepted"><day>30</day><month>7</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><self-uri xlink:href="btz601.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Summary</title><p>Single cell RNA sequencing is a revolutionary technique to characterize inter-cellular transcriptomics heterogeneity. However, the data are noise-prone because gene expression is often driven by both technical artifacts and genuine biological variations. Proper disentanglement of these two effects is critical to prevent spurious results. While several tools exist to detect and remove low-quality cells in one single cell RNA-seq dataset, there is lack of approach to examining consistency between sample sets and detecting systematic biases, batch effects and outliers. We present scRNABatchQC, an R package to compare multiple sample sets simultaneously over numerous technical and biological features, which gives valuable hints to distinguish technical artifact from biological variations. scRNABatchQC helps identify and systematically characterize sources of variability in single cell transcriptome data. The examination of consistency across datasets allows visual detection of biases and outliers.</p></sec><sec id="s2"><title>Availability and implementation</title><p>scRNABatchQC is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/liuqivandy/scRNABatchQC">https://github.com/liuqivandy/scRNABatchQC</ext-link> as an R package.</p></sec><sec id="s3"><title>Supplementary information</title><p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">National Cancer Institute</named-content><named-content content-type="funder-identifier">10.13039/100000054</named-content></funding-source><award-id>U2C CA233291</award-id><award-id>U54 CA217450</award-id></award-group></funding-group><counts><page-count count="3"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Single cell RNA-sequencing (scRNA-seq) is a powerful technique of whole-transcriptome profiling at the resolution of individual cells. It has been successfully used to discover rare and heterogeneous cell populations, and reconstruct developmental trajectories (<xref rid="btz601-B1" ref-type="bibr">Carter <italic>et al.</italic>, 2018</xref>; <xref rid="btz601-B4" ref-type="bibr">Karaayvaz <italic>et al.</italic>, 2018</xref>).</p><p>One major challenge in scRNA-seq analysis is to detect technical artifacts and remove poor quality cells. Previous studies have employed different strategies to detect technical artifacts (<xref rid="btz601-B2" ref-type="bibr">Ilicic <italic>et al.</italic>, 2016</xref>; <xref rid="btz601-B3" ref-type="bibr">Jiang <italic>et al.</italic>, 2016</xref>; <xref rid="btz601-B5" ref-type="bibr">Lun <italic>et al.</italic>, 2016</xref>; <xref rid="btz601-B6" ref-type="bibr">McCarthy <italic>et al.</italic>, 2017</xref>; <xref rid="btz601-B8" ref-type="bibr">Tian <italic>et al.</italic>, 2018</xref>). They generally use features such as overall gene expression patterns, number of genes detected and housekeeping genes or spike-in RNA. For example, SinQC integrated both gene expression patterns and sample sequencing library qualities, such as total number of mapped reads, mapping rate and library complexity to detect technical artifacts (<xref rid="btz601-B3" ref-type="bibr">Jiang <italic>et al.</italic>, 2016</xref>). Ilicic <italic>et al.</italic> used biological and technical features, including number of genes detected, number of mapped reads and percentage of mitochondrial genes to train a SVM model to distinguish low from high quality cells (<xref rid="btz601-B2" ref-type="bibr">Ilicic <italic>et al.</italic>, 2016</xref>). The Scater and scPipe packages provided methods to compute a variety of QC metrics and visualization to diagnose potential issues (<xref rid="btz601-B6" ref-type="bibr">McCarthy <italic>et al.</italic>, 2017</xref>; <xref rid="btz601-B8" ref-type="bibr">Tian <italic>et al.</italic>, 2018</xref>). These strategies successfully identify compromised cells within a single dataset. For integrated or comparative analysis of large collections of scRNA-seq experiments, quality assessment across datasets is crucial to detect outliers, potential batch effects, or systematic biases since they will mask underlying biology and result in misleading conclusions.</p><p>Here, we present scRNABatchQC, an R package designed to assess the similarity/difference across scRNA-seq datasets over numerous technical factors, biological features, expression profiles and related pathways. By comparing technical and biological metrics across datasets, scRNABatchQC enables the detection of systematic errors, batch effects or outlier samples. It will greatly improve quality control and reproducibility analysis for single-cell RNA sequencing.</p></sec><sec><title>2 Implementation</title><p>scRNABatchQC is written in R. It is easy to implement even for users with limited programming experience. There is only one required input, gene-by-cell count matrices, which can be supplied by any delimited files or compressed files (ending gz or .bz2), or read from 10X, SingleCellExperiment or Seurat v3 object. Besides, there are optional arguments that users can specify or adjust, such as the organism, the number of highly variable genes (HVGs), the number of principle components (PCs), scale factor, etc.scRNABatchQC summarizes QC report in one html file, which includes six sections: Overview, QC summary, Technical View, Biological View, Expression Similarity and Pairwise Difference (<xref ref-type="fig" rid="btz601-F1">Fig.&#x000a0;1</xref>). The Overview gives a brief introduction of the software. QC summary provides a table listing a variety of QC metrics, such as the number of total counts/cells/genes, the cutoff for filtering cells, the number of cells removed due to low quality in each sample. Technical View presents diagnostic graphics on 11 technical features, such as the distribution of total counts and the variance explained by total counts in each sample, mean-variance trend, etc. Biological View compares the HVGs, the genes related to one specific principal component (PC-related genes), and their enriched pathways if the organism is supported by WebGestalt (<xref rid="btz601-B9" ref-type="bibr">Zhang <italic>et al.</italic>, 2005</xref>). Expression Similarity provides the global expression correlation across datasets, and two low-dimensional embedding of all cells, principal component analysis and t-distributed stochastic nearest-neighbor embedding. Pairwise Difference identifies differentially expressed genes between all pairs of samples and pathways associated with these genes (Methods Description in the <xref ref-type="supplementary-material" rid="sup1">Supplementary File S1</xref>). In addition to the html file, scRNABatchQC stores the gene-by-cell count matrices and QC metadata in SingleCellExperiment objects, which ensures the output of scRNABatchQC compatible with other Bio-conductor workflows.
</p><fig id="btz601-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>The outline of scRNABatchQC </p></caption><graphic xlink:href="btz601f1"/></fig></sec><sec><title>3 Application</title><p>For demonstration, we used scRNA-seq data of mouse retinal bipolar cells, which includes a total of 44&#x000a0;994 cells in 6 replicates prepared from 2 experimental batches (<xref rid="btz601-B7" ref-type="bibr">Shekhar <italic>et al.</italic>, 2016</xref>). Batch 1 has 4 replicates (S1&#x02013;S4), while batch 2 consists of 2 replicates (S5 and S6). <xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref> is the output generated by scRNABatchQC.</p><p>The report summarizes that batch 1 has &#x0223c;4500 cells/replicate, and batch 2 has &#x0223c;13&#x000a0;000 cells/replicate. Compared to batch 1, batch 2 has more cells with high percentage of mitochondrial RNA genes (the maximum percentage is 70%&#x0223c;80%), which were removed from downstream analysis due to low quality (<xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref>: QC Summary). Batches 1 and 2 present different distributions on all 11 technical features (<xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref>: <xref ref-type="supplementary-material" rid="sup1">Figs S1&#x02013;11</xref>), suggesting the existence of batch effects. For example, batch 2 shows a more rapid increase in the expression cumulative plot, suggesting a library with lower complexity (<xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref>: <xref ref-type="supplementary-material" rid="sup1">Fig. S5</xref>). Biological View illustrates that six samples are very similar in their HVGs, all enriched for processes related to photo-transduction. These results suggest that HVGs mainly capture the biological variations across cell types, and six samples share similar biological heterogeneity and cellular compositions. Although being very similar, samples are still clustered by their batch, indicating that batch effects have some minor effect on variations within samples (<xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref>: <xref ref-type="supplementary-material" rid="sup1">Figs S12 and 13</xref>). Pairwise Difference identifies differentially expressed genes between two batches, such as Xist, Hopx, mt-Rnr1 and mt-Rnr2 (<xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref>: <xref ref-type="supplementary-material" rid="sup1">Fig. S19</xref>). No enriched pathways are detected for these differential genes, therefore <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S20</xref> is not generated. Xist, Hopx are sex-related genes, while mt-Rnr1 and mt-Rnr2 are mitochondrial RNA genes. These results suggest that differences in the sex populations and library preparation between the two batches are likely to contribute to batch effects, which is consistent with the original paper (<xref rid="btz601-B7" ref-type="bibr">Shekhar <italic>et al.</italic>, 2016</xref>).</p></sec><sec><title>4 Conclusion</title><p>Large-scale projects, such as Human Cell Atlas, are now generating comprehensive collections of scRNA-seq datasets. Understanding the existence and the sources of experimental noise is very important to integration and interpretation of the data. scRNABatchQC, a quality assessment tool over numerous technical and biological features, not only provides a global overview of all experiments, but also enables the examination of technical or biological origin of discrepancies between experiments and detect possible outliers and batch effects. scRNABatchQC can also be applied to other single cell experiments, such as single nuclei RNA-seq.</p></sec><sec><title>Funding</title><p>This work was supported by the National Cancer Institute grants (U2C CA233291 and U54 CA217450).</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>btz601_Supplementary_Data</label><media xlink:href="btz601_supplementary_data.zip"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list id="ref1"><title>References</title><ref id="btz601-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Carter</surname><given-names>R.A.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>A single-cell transcriptional atlas of the developing murine cerebellum</article-title>. <source>Curr. Biol</source>., <volume>28</volume>, 2910&#x02013;2920.e2.</mixed-citation></ref><ref id="btz601-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ilicic</surname><given-names>T.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Classification of low quality cells from single-cell RNA-seq data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>29.</fpage><pub-id pub-id-type="pmid">26887813</pub-id></mixed-citation></ref><ref id="btz601-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jiang</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Quality control of single-cell RNA-seq by SinQC</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2514</fpage>&#x02013;<lpage>2516</lpage>.<pub-id pub-id-type="pmid">27153613</pub-id></mixed-citation></ref><ref id="btz601-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Karaayvaz</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Unravelling subclonal heterogeneity and aggressive disease states in TNBC through single-cell RNA-seq</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>3588</fpage>.<pub-id pub-id-type="pmid">30181541</pub-id></mixed-citation></ref><ref id="btz601-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>A.T.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>. <source>F1000Research</source>, <volume>5</volume>, <fpage>2122.</fpage><pub-id pub-id-type="pmid">27909575</pub-id></mixed-citation></ref><ref id="btz601-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>McCarthy</surname><given-names>D.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Scater: pre-processing, quality control, normalization and visualization of single-cell RNA-seq data in R</article-title>. <source>Bioinformatics</source><volume>33</volume>, <fpage>1179</fpage>&#x02013;<lpage>1186</lpage>.<pub-id pub-id-type="pmid">28088763</pub-id></mixed-citation></ref><ref id="btz601-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Shekhar</surname><given-names>K.</given-names></name></person-group>, <etal>et al</etal> (<year>2016</year>) 
<article-title>Comprehensive classification of retinal bipolar neurons by single-cell transcriptomics</article-title>. <source>Cell</source><volume>166</volume>, 1308&#x02013;1323.e30.</mixed-citation></ref><ref id="btz601-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tian</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>scPipe: a flexible R/Bioconductor preprocessing pipeline for single-cell RNA-sequencing data</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1006361.</fpage><pub-id pub-id-type="pmid">30096152</pub-id></mixed-citation></ref><ref id="btz601-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>B.</given-names></name></person-group>
<etal>et al</etal> (<year>2005</year>) 
<article-title>WebGestalt: an integrated system for exploring gene sets in various biological contexts</article-title>. <source>Nucleic Acids Res</source>., <volume>33</volume>, <fpage>W741</fpage>&#x02013;<lpage>W748</lpage>.<pub-id pub-id-type="pmid">15980575</pub-id></mixed-citation></ref></ref-list></back></article>