<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.2 20190208//EN" "JATS-archivearticle1-mathml3.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">31165139</article-id><article-id pub-id-type="pmc">6954644</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btz447</article-id><article-id pub-id-type="publisher-id">btz447</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Papers</subject><subj-group subj-group-type="category-toc-heading"><subject>Gene Expression</subject></subj-group></subj-group></article-categories><title-group><article-title>Gene set enrichment for reproducible science: comparison of CERNO and eight other algorithms</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2895-7969</contrib-id><name><surname>Zyla</surname><given-names>Joanna</given-names></name><xref ref-type="aff" rid="btz447-aff1">1</xref><xref ref-type="aff" rid="btz447-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Marczyk</surname><given-names>Michal</given-names></name><xref ref-type="aff" rid="btz447-aff1">1</xref><xref ref-type="aff" rid="btz447-aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Domaszewska</surname><given-names>Teresa</given-names></name><xref ref-type="aff" rid="btz447-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Kaufmann</surname><given-names>Stefan H E</given-names></name><xref ref-type="aff" rid="btz447-aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Polanska</surname><given-names>Joanna</given-names></name><xref ref-type="aff" rid="btz447-aff1">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1438-7819</contrib-id><name><surname>Weiner</surname><given-names>January</given-names><suffix>3rd</suffix></name><xref ref-type="corresp" rid="btz447-cor1"/><xref ref-type="aff" rid="btz447-aff2">2</xref><!--<email>january.weiner@mpiib-berlin.mpg.de</email>--></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Wren</surname><given-names>Jonathan</given-names></name><role>Associate Editor</role></contrib></contrib-group><aff id="btz447-aff1"><label>1</label>
<institution>Data Mining Group, Faculty of Automatic Control, Electronic and Computer Science, Institute of Automatic Control, Silesian University of Technology</institution>, Gliwice, <country country="PL">Poland</country></aff><aff id="btz447-aff2"><label>2</label>
<institution>Department of Immunology, Max Planck Institute for Infection Biology</institution>, Berlin, <country country="DE">Germany</country></aff><aff id="btz447-aff3"><label>3</label>
<institution>Yale School of Medicine, Yale Cancer Center</institution>, New Haven, CT 06510, <country country="US">USA</country></aff><author-notes><corresp id="btz447-cor1">To whom correspondence should be addressed. E-mail: <email>january.weiner@mpiib-berlin.mpg.de</email></corresp></author-notes><pub-date pub-type="ppub"><day>15</day><month>12</month><year>2019</year></pub-date><pub-date pub-type="epub" iso-8601-date="2019-06-04"><day>04</day><month>6</month><year>2019</year></pub-date><pub-date pub-type="pmc-release"><day>04</day><month>6</month><year>2019</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. --><volume>35</volume><issue>24</issue><fpage>5146</fpage><lpage>5154</lpage><history><date date-type="received"><day>10</day><month>12</month><year>2018</year></date><date date-type="rev-recd"><day>08</day><month>5</month><year>2019</year></date><date date-type="accepted"><day>10</day><month>6</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2019. Published by Oxford University Press.</copyright-statement><copyright-year>2019</copyright-year><license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/"><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p></license></permissions><self-uri xlink:href="btz447.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Analysis of gene set (GS) enrichment is an essential part of functional omics studies. Here, we complement the established evaluation metrics of GS enrichment algorithms with a novel approach to assess the practical reproducibility of scientific results obtained from GS enrichment tests when applied to related data from different studies.</p></sec><sec id="s2"><title>Results</title><p>We evaluated eight established and one novel algorithm for reproducibility, sensitivity, prioritization, false positive rate and computational time. In addition to eight established algorithms, we also included Coincident Extreme Ranks in Numerical Observations (CERNO), a flexible and fast algorithm based on modified Fisher <italic>P</italic>-value integration. Using real-world datasets, we demonstrate that CERNO is robust to ranking metrics, as well as sample and GS size. CERNO had the highest reproducibility while remaining sensitive, specific and fast. In the overall ranking Pathway Analysis with Down-weighting of Overlapping Genes, CERNO and over-representation analysis performed best, while CERNO and GeneSetTest scored high in terms of reproducibility.</p></sec><sec id="s3"><title>Availability and implementation</title><p>tmod package implementing the CERNO algorithm is available from CRAN (cran.r-project.org/web/packages/tmod/index.html) and an online implementation can be found at <ext-link ext-link-type="uri" xlink:href="http://tmod.online/">http://tmod.online/</ext-link>. The datasets analyzed in this study are widely available in the KEGGdzPathwaysGEO, KEGGandMetacoreDzPathwaysGEO R package and GEO repository.</p></sec><sec id="s4"><title>Supplementary information</title><p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Bill &#x00026; Melinda Gates Foundation Grand Challenges in Global Health Program</named-content></funding-source><award-id>BMGF GC6-74</award-id><award-id>#37772</award-id><award-id>GC6-2013</award-id><award-id>OPP1055806</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">BioVacSafe</named-content></funding-source><award-id>115308</award-id><award-id>TBVAC 2020 643381</award-id></award-group><award-group award-type="grant"><funding-source><named-content content-type="funder-name">Polish National Science Center</named-content></funding-source><award-id>2015/19/B/ST6/01736</award-id><award-id>POIG.02.03.01-24-099/13</award-id></award-group></funding-group><counts><page-count count="9"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>One of the most common applications of transcriptomic analyses is the detection of differentially expressed genes (DEGs) that allows characterizing transcriptomic profiles of investigated conditions. However, the number of true discoveries depends on the power of conducted studies. In extreme cases, e.g. when the experiment is underpowered, no DEGs can be observed despite the existence of a true effect. However, a large number of DEGs can hinder a meaningful interpretation. Thus, instead of analyzing single genes, it is often better to investigate co-expression and synergistic reactions on the level of gene sets (GSs) (<xref rid="btz447-B38" ref-type="bibr">Mootha <italic>et al.</italic>, 2003</xref>). Several collections of GSs and molecular interactions are established, including the knowledge-based Gene Ontology (<xref rid="btz447-B8" ref-type="bibr">GO; Consortium, 2012</xref>), Kyoto Encyclopedia of Genes and Genomes (KEGG; <xref rid="btz447-B30" ref-type="bibr">Kanehisa <italic>et al.</italic>, 2016</xref>), Molecular Signatures Database (<xref rid="btz447-B47" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>) or REACTOME (<xref rid="btz447-B9" ref-type="bibr">Croft <italic>et al.</italic>, 2014</xref>) as well as collection of GS related to particular stimulations, e.g. immune system stimulation by vaccination or a disease (<xref rid="btz447-B7" ref-type="bibr">Chaussabel <italic>et al.</italic>, 2008</xref>; <xref rid="btz447-B21" ref-type="bibr">Godec <italic>et al.</italic>, 2016</xref>; <xref rid="btz447-B33" ref-type="bibr">Li <italic>et al.</italic>, 2014</xref>).</p><p>To transform information from expression of individual genes to the level of a collection of GS, enrichment methods were introduced. The first generation of enrichment methods is known as Over-representation Analysis (ORA; <xref rid="btz447-B52" ref-type="bibr">Tavazoie <italic>et al.</italic>, 1999</xref>). The main concept of ORA methods is to divide the genes into DEGs and background, as well as into genes which are members of a particular GS (or not) and test the contingency table between these two divisions using an appropriate statistical test (such as hypergeometric, &#x003c7;<sup>2</sup> or Fisher&#x02019;s exact test). The GSs are tested consecutively, and the resulting <italic>P</italic>-values are corrected for multiple testing. The first generation methods have two serious drawbacks. First, only binary information about statistically different expression between conditions is used. Genes are divided into DEGs and background by setting arbitrary log-fold change or <italic>P</italic>-value thresholds. However, the number of genes over the threshold will strongly depend on sample size. Second, the assumption of independence in the statistical tests applied is not fulfilled in most of the cases (<xref rid="btz447-B14" ref-type="bibr">Efron and Tibshirani, 2007</xref>; <xref rid="btz447-B23" ref-type="bibr">Goeman <italic>et al.</italic>, 2004</xref>; <xref rid="btz447-B48" ref-type="bibr">Tamayo <italic>et al.</italic>, 2016</xref>).</p><p>The second generation of enrichment methods is the Functional Class Sorting (FCS; <xref rid="btz447-B38" ref-type="bibr">Mootha <italic>et al.</italic>, 2003</xref>) techniques. FCS techniques use information about all analyzed genes in the form of a gene list sorted according to certain metrics. Moreover, some methods incorporate the information about the effect size of the difference in gene expression between the groups (e.g. in form of a ranking value or test statistic such as the t statistic from a <italic>t</italic>-test) into the information transformation process from gene to pathway level. As in ORA, each GS is analyzed independently. Several FCS methods have been proposed, including Gene Set Enrichment Analysis (GSEA) (<xref rid="btz447-B47" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>), Pathway Level Analysis of Gene Expression (PLAGE) (<xref rid="btz447-B53" ref-type="bibr">Tomfohr <italic>et al.</italic>, 2005</xref>), Pathway Analysis with Down-weighting of Overlapping Genes (PADOG) (<xref rid="btz447-B50" ref-type="bibr">Tarca <italic>et al.</italic>, 2012</xref>), LEGO (<xref rid="btz447-B12" ref-type="bibr">Dong <italic>et al.</italic>, 2016</xref>), singscore (<xref rid="btz447-B19" ref-type="bibr">Foroutan <italic>et al.</italic>, 2018</xref>) and hybrid approaches like EGSEA (<xref rid="btz447-B2" ref-type="bibr">Alhamdoosh <italic>et al.</italic>, 2017</xref>). A brief description of second generation GS enrichment algorithms used in this study is found in &#x02018;Materials and methods&#x02019;.</p><p>Finally, Pathway Topology (PT)-based approaches (<xref rid="btz447-B41" ref-type="bibr">Rahnenf&#x000fc;hrer <italic>et al.</italic>, 2004</xref>) comprise the third generation of enrichment methods. PT-based approaches are similar to FCS, but they incorporate the PT to compute gene-level statistics. This group includes methods such as NetGSEA (<xref rid="btz447-B44" ref-type="bibr">Shojaie and Michailidis, 2010</xref>), CePa (<xref rid="btz447-B24" ref-type="bibr">Gu <italic>et al.</italic>, 2012</xref>) or hybrid approaches SPIA (<xref rid="btz447-B51" ref-type="bibr">Tarca <italic>et al.</italic>, 2009</xref>), EnrichmentBrowser (<xref rid="btz447-B20" ref-type="bibr">Geistlinger <italic>et al.</italic>, 2016</xref>). While third generation methods capture the complexity of molecular biology in a convenient way, they still suffer from major drawbacks. First, PT depends on cell type, cell cycle phase or specific environmental conditions, an information that is rarely available (<xref rid="btz447-B31" ref-type="bibr">Khatri <italic>et al.</italic>, 2012</xref>). Second, they are not applicable to many nonstandard applications, making the third generation methods highly specialized tools available only for transcriptomic analyses in the most common model organisms and humans. Third, they require computational capacities similar to FCS permutation methods or higher, which in terms of large studies could require a computational cluster. Moreover, the knowledge about molecular biology networks evolves rapidly outdating the analyses performed using PT. Finally, a substantial variation of results obtained using PT algorithms has been demonstrated (<xref rid="btz447-B27" ref-type="bibr">Ihnatova <italic>et al.</italic>, 2018</xref>). Other classifications of enrichment methods exist (<xref rid="btz447-B22" ref-type="bibr">Goeman and B&#x000fc;hlmann, 2007</xref>; <xref rid="btz447-B26" ref-type="bibr">Huang <italic>et al.</italic>, 2009</xref>; <xref rid="btz447-B35" ref-type="bibr">Maciejewski, 2014</xref>).</p><p>Given the limitations of third generation algorithms, both first and second generation methods are still widely used and no gold-standard approach has been established yet. A recent comparison (<xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic>, 2013</xref>) showed that PLAGE (<xref rid="btz447-B53" ref-type="bibr">Tomfohr <italic>et al.</italic>, 2005</xref>), GLOBALTEST (<xref rid="btz447-B23" ref-type="bibr">Goeman <italic>et al.</italic>, 2004</xref>) and PADOG (<xref rid="btz447-B50" ref-type="bibr">Tarca <italic>et al.</italic>, 2012</xref>) are all characterized by good overall sensitivity and relative position of true positives in results. Nevertheless, in that study the specificity of the algorithms was calculated only for methods classified as second generation and by using a permutation applied to genes rather than samples. However, it has been shown before that permutation of genes is problematic and results in an apparent low performance of the algorithms due to breaking original gene correlations (Maciejewski, 2014). Moreover, substantial variation in specificity is known to exist (<xref rid="btz447-B12" ref-type="bibr">Dong <italic>et al.</italic>, 2016</xref>). Other studies were limited to empirical evaluation of only a few algorithms (<xref rid="btz447-B1" ref-type="bibr">Abatangelo, 2009</xref>; <xref rid="btz447-B40" ref-type="bibr">Powers <italic>et al.</italic>, 2018</xref>).</p><p>In the course of our own work in various applications of systems biology, we have used several of these methods, and found (without using a systematic approach) that one of the major issues is to obtain high sensitivity and reproducibility of the findings produced by different methods in a dataset or by the same method in different datasets. Searching for a robust approach we and others (<xref rid="btz447-B11" ref-type="bibr">Domaszewska <italic>et al.</italic>, 2017</xref>; <xref rid="btz447-B15" ref-type="bibr">El-Chemaly <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B32" ref-type="bibr">Kunnath-Velayudhan <italic>et al.</italic>, 2010</xref>; <xref rid="btz447-B34" ref-type="bibr">Loxton <italic>et al.</italic>, 2016</xref>; <xref rid="btz447-B42" ref-type="bibr">Ritchie <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B43" ref-type="bibr">Santoro <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B54" ref-type="bibr">Toro&#x02010;Dom&#x000ed;nguez <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B55" ref-type="bibr">Van Den Berg <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B57" ref-type="bibr">Weiner <italic>et al.</italic>, 2018</xref>) have successfully applied a statistical approach called Coincident Extreme Ranks in Numerical Observations (CERNO; <xref rid="btz447-B58" ref-type="bibr">Yamaguchi <italic>et al.</italic>, 2008</xref>), which is based on a modified Fisher&#x02019;s combined probability test. CERNO has several advantages; notably, as it uses as input an ordered gene list, any metric can be used to sort the features, resulting in impressive flexibility. CERNO, thus can be combined with diverse approaches including data integration and multidimensional scaling techniques. It produces a well-described statistic (&#x003c7;<sup>2</sup>) and therefore does not require a randomization approach like GSEA (<xref rid="btz447-B47" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>), making its implementation fast and powerful even for small sample sizes. A limited comparison with GSEA showed its superiority for small sample sizes and a remarkable robustness (<xref rid="btz447-B56" ref-type="bibr">Weiner and Domaszewska, 2016</xref>). Despite the apparent flexibility and robustness, it has never been systematically compared to other approaches. Moreover, the assumption of independence of <italic>P</italic>-values which is underlying Fisher&#x02019;s method is not fulfilled. Thus, one of the goals of our work was to test the false discovery rate for the CERNO algorithm.</p><p>Our main concern in comparing GS enrichment algorithms was the reproducibility of results obtained in different studies. The issue of scientific reproducibility has been the subject of an important debate of the last decade (<xref rid="btz447-B4" ref-type="bibr">Baker, 2016</xref>; <xref rid="btz447-B39" ref-type="bibr">Munaf&#x000f2; <italic>et al.</italic>, 2017</xref>). In particular, we wanted to know the extent to which the results of GS enrichment analyses are reproducible when compared across different scientific studies. Here we present a novel measure of enrichment analysis performance aimed at gauging reproducibility. The new metric is based on comparing enrichment results obtained with a given algorithm across multiple studies of clear cell renal cell carcinoma (ccRCC). The aim of this work was to compare second generation enrichment tests, in particular CERNO, using both well-known evaluation metrics as well as our novel measure of reproducibility. Several previous studies using compared enrichment methods using different approaches and metrics e.g. sensitivity, specificity and prioritization (<xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic>, 2013</xref>; <xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>), discrimination (<xref rid="btz447-B59" ref-type="bibr">Yu <italic>et al.</italic>, 2017</xref>), accuracy (<xref rid="btz447-B6" ref-type="bibr">Bayerlov&#x000e1; <italic>et al.</italic>, 2015</xref>), false discovery rate (<xref rid="btz447-B29" ref-type="bibr">Jaakkola <italic>et al.</italic>, 2018</xref>), power analysis via semisynthetic simulation tool (<xref rid="btz447-B37" ref-type="bibr">Mathur <italic>et al.</italic>, 2018</xref>) or comparative analysis via simulation study (<xref rid="btz447-B1" ref-type="bibr">Abatangelo, 2009</xref>). Here we focus on sensitivity, specificity and prioritization (<xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic>, 2013</xref>; <xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>) accompanied by a novel measure with the intention of assessing the reproducibility of an algorithm. In addition, we tested the impact of chosen ranking metric and sample size on the results of the CERNO algorithm. All analyses were performed on publicly available benchmark datasets to ensure replicability of our study and to provide a new standard of evaluation of GS enrichment methods.</p></sec><sec><title>2 Materials and methods</title><sec><title>2.1 CERNO algorithm</title><p>GS enrichment with CERNO (<xref rid="btz447-B58" ref-type="bibr">Yamaguchi <italic>et al.</italic>, 2008</xref>) is performed on a list of genes sorted by a given ranking metric. The null hypothesis assumes a random distribution of genes belonging to individual GS. The proposed test is a modification of Fisher&#x02019;s method for integrating probabilities (<xref rid="btz447-B18" ref-type="bibr">Fisher, 1992</xref>). For each GS the test statistic <italic>F</italic> is calculated as:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ln</mml:mi></mml:mrow><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">tot</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>&#x0223c;</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">&#x003c7;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic>N</italic> is the total number of genes in a given GS, <italic>N</italic><sub>tot</sub> is the total number of investigated genes and <italic>r<sub>i</sub></italic> is the rank of gene <italic>i</italic> (in a given GS) in the sorted gene list. The final <italic>F</italic> statistics can be approximated as &#x003c7;<sup>2</sup> distribution with <italic>2*N</italic> degrees of freedom. The CERNO algorithm has been implemented in our R package, <italic>tmod</italic>. We extended the approach by adding effect size estimation, support for randomization-based testing, adjustment for multiple testing, a possibility of testing different gene collections and novel ranking metrics, minimum significant difference (MSD) (<xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>). Several other enrichment methods are also implemented (i.e. ORA, PLAGE, GeneSetTest, Wilcoxon GST) in <italic>tmod</italic>, which makes our package versatile in terms of enrichment analysis. Furthermore, we developed new visualization methods (<xref ref-type="fig" rid="btz447-F1">Fig.&#x000a0;1</xref>), including charts dedicated to visualize numerous conditions and dependencies between <italic>P</italic>-value and effect size (<xref ref-type="fig" rid="btz447-F1">Fig.&#x000a0;1A</xref>), word cloud visualizations of enrichment (<xref ref-type="fig" rid="btz447-F1">Fig.&#x000a0;1B</xref>), detailed efficiency of selected pathway (<xref ref-type="fig" rid="btz447-F1">Fig.&#x000a0;1C</xref>) as well as multidimensional functional annotations of components e.g. from principal component analysis (PCA) (<xref ref-type="fig" rid="btz447-F1">Fig.&#x000a0;1D</xref>).
</p><fig id="btz447-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Examples of <italic>tmod</italic> package graphical illustrations of enrichment results. (<bold>A</bold>) A panel plot which allows presentation of large number of comparisons; (<bold>B</bold>) a tag cloud for enriched GS; (<bold>C</bold>) evidence plot for a selected GS, where the AUC corresponds to effect size; (D) principle component analysis combined with enrichment allows to functionally annotate the components</p></caption><graphic xlink:href="btz447f1"/></fig><p>Compared to other second generation enrichment methods the CERNO method implemented in <italic>tmod</italic> offers several advantages: (i) short evaluation time as a randomization-based test (performed e.g. in GSEA) is not required; (ii) simple input dataset in the form of a sorted list of genes; (iii) ranking method depends on the user, which enables sorting of genes according to any suitable metric; (iv) the R implementation is not limited for analysis of default GSs (any GS can be tested); (v) CERNO weighs the low-ranking genes more than intermediate one thereby decreasing the influence of the GS size on the enrichment result. Despite above mentioned advantages, CERNO algorithm does not account for correlation of expression between genes, which can potentially result in an increased number of false positive results. This issue of correlation between genes has not been resolved for a few of all the second generation algorithms. <italic>tmod</italic> package is available from CRAN (cran.r-project.org/web/packages/tmod/index.html) while an online implementation can be found at <ext-link ext-link-type="uri" xlink:href="http://tmod.on">http://tmod.on</ext-link>line/.</p></sec><sec><title>2.2 Further algorithms used in the evaluation</title><p>CERNO was compared to eight other popular algorithms. ORA, implemented in GOstat package (<xref rid="btz447-B17" ref-type="bibr">Falcon and Gentleman, 2007</xref>), constructs contingency tables for each GS containing the number of DEGs and non-DEGs. DEGs and non-DEGS were established according to <italic>P</italic>-values from <italic>t</italic>-test for unequal variances (<italic>&#x003b1;</italic> = 0.05). Next, hypergeometric test is performed to get significance of each GS. In the group of tested algorithms, it is the only representing first generation of enrichment methods.</p><p>Furthermore, we used the top three algorithm presented in <xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic> (2013)</xref>, i.e. GLOBALTEST (<xref rid="btz447-B23" ref-type="bibr">Goeman <italic>et al.</italic>, 2004</xref>), PADOG (<xref rid="btz447-B50" ref-type="bibr">Tarca <italic>et al.</italic>, 2012</xref>), PLAGE (<xref rid="btz447-B53" ref-type="bibr">Tomfohr <italic>et al.</italic>, 2005</xref>), with addition of GSVA (Gene Set Variation Analysis; <xref rid="btz447-B25" ref-type="bibr">H&#x000e4;nzelmann <italic>et al.</italic>, 2013</xref>), GSEA (<xref rid="btz447-B47" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>) and two algorithms implemented in the limma R package: GeneSetTest and Wilcoxon GST (Wilcoxon GeneSetTest; <xref rid="btz447-B45" ref-type="bibr">Smyth, 2005</xref>).</p><p>In the following, we briefly describe the second generation algorithms included in our comparison. GLOBALTEST uses a logistic regression model to assess significance of a given GS (<xref rid="btz447-B23" ref-type="bibr">Goeman <italic>et al.</italic>, 2004</xref>). More precisely, it tests whether the regression coefficients for all genes in individual GS equal zero. PADOG calculates pathway scores as the weighted sum of absolute moderated gene <italic>t</italic>-scores, with gene weights being lower for genes that are common across the collection of GSs being analyzed. This allows to account for genes which appear in many GSs. Next, the gene-level information is transformed to pathway-level significance. PLAGE first standardizes expressions by calculating <italic>z</italic>-scores and then performs a singular value decomposition. The first right singular vector of coefficients (analogous to the first component in PCA) is used as GS score (<xref rid="btz447-B53" ref-type="bibr">Tomfohr <italic>et al.</italic>, 2005</xref>) and significance is obtained from a <italic>t</italic>-test comparing the scores between groups. GSVA (<xref rid="btz447-B25" ref-type="bibr">H&#x000e4;nzelmann <italic>et al.</italic>, 2013</xref>) estimates the gene expression distribution over the samples by nonparametric kernel distribution, which puts expression profiles on a common scale. Then, the Kolmogorov&#x02013;Smirnov-like statistic is calculated to obtain a summary GS score. GSEA (<xref rid="btz447-B47" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>) is one of the most commonly used algorithms in enrichment analysis. Using a permutation-based approach on a weighted Kolmogorov&#x02013;Smirnov statistic, GSEA tests whether the distribution of the gene ranks in the GS differs significantly from a uniform distribution. Finally, we used GeneSetTest and Wilcoxon GST, the latter being a modification of GeneSetTest known as mean-rank GS enrichment. Both algorithms test genes selected as DEGs in one dataset and determine whether a given GS tends to be highly ranked in the training dataset. The computed test statistic is the mean rank of the GS in the test dataset.</p><p>Starting parameters for each algorithm are presented in <xref ref-type="supplementary-material" rid="sup1">Supplementary File S1</xref>. In general, we used the parameters recommended by the authors of each package. For paired design datasets the absolute value of <italic>t</italic>-statistic for paired samples was used for all algorithms.</p></sec><sec><title>2.3 Datasets</title><p>All algorithms were tested using two publicly available microarray dataset collections. Both collections are available as R packages, KEGGdzPathwaysGEO (<xref rid="btz447-B50" ref-type="bibr">Tarca <italic>et al.</italic>, 2012</xref>) and KEGGandMetacoreDzPathwaysGEO (<xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic>, 2013</xref>). From second collection, we removed datasets which are associated with a target pathway from the Metacore database to keep the analysis dependent only on open access sources. In addition, we used ccRCC (<xref rid="btz447-B28" ref-type="bibr">Jaakkola and Elo, 2016</xref>) datasets from Gene Expression Omnibus (IDs: GSE6344, GSE15641, GSE14994, GSE11024; <xref rid="btz447-B13" ref-type="bibr">Edgar <italic>et al.</italic>, 2002</xref>). In total, the collection of comprised 38 benchmark microarray datasets with 32 samples in average; the smallest dataset consisted of 8 samples, and the largest 153 samples. Duplicates of probeset assignments to genes were removed according to the following procedures: (i) in KEGGdzPathwaysGEO datasets the probe set with the smallest <italic>P</italic>-value was kept; (ii) in KEGGandMetacoreDzPathwaysGEO and ccRCC datasets the probe set with the highest average expression across all samples was kept (<xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic>, 2013</xref>). For each dataset and the corresponding disease, the target pathway (true positive) from KEGGs (Kanehisa <italic>et al.</italic>, 2016) was matched for measuring efficiency of tested algorithms (<xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic>, 2013</xref>). The used dataset collection is characterized by not strongly skewed distributions of gene expression (see Additional file 2 in <xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>). KEGG pathways were downloaded as a collection of GS via KEGGREST package resulting in 299 different pathways. Detailed description of the 38 datasets and their target pathways is presented in <xref ref-type="supplementary-material" rid="sup1">Supplementary File S2</xref>.</p></sec><sec><title>2.4 Algorithm evaluation measures</title><p>The testing procedure included five measures: sensitivity, false positive rate (FPR), computational time, prioritization and reproducibility. We used the first four surrogate measures previously introduced by <xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic> (2013)</xref> and further defined in <xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic> (2017b</xref>). Sensitivity was determined by analyzing the distribution of GS <italic>P</italic>-values of target pathway and by introducing the conservative estimator <inline-formula id="IE1"><mml:math id="IM1"><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> from Storey&#x02019;s method for multiple testing, where <inline-formula id="IE2"><mml:math id="IM2"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> shows the proportion of truly alternative tests (<xref rid="btz447-B46" ref-type="bibr">Storey, 2002</xref>). FPR measure was obtained by permutation procedure as follows. The original phenotypes were permuted 50 times in each dataset. Next, each enrichment algorithm was applied and mean value of GSs with <italic>P</italic>-value &#x0003c;5% was calculated. Finally, we computed the absolute deviation of mean FPR (observed level) from 5% (expected level). Computational time was collected during sensitivity analyses on the same PC for each algorithm. Surrogate prioritization is position of dataset target pathway in result list standardized to total number of analyzed pathways. The median value from analyzed datasets in each algorithm represents prioritization.</p><p>We introduce a fifth evaluation measure aimed at gauging the reproducibility of the tested algorithms (<xref ref-type="fig" rid="btz447-F2">Fig.&#x000a0;2</xref>). The rationale here was to assign a high score to algorithms that showed consistent results in different datasets corresponding to the same physiological condition. For this, we used six ccRCC datasets (GSE14762, GSE781, GSE6344, GSE15641, GSE14994, GSE11024). Since the same disease was investigated in each dataset, we aimed at identifying the algorithm which highlights similar pathways in every dataset to give the most reproducible results. We have chosen these datasets with the following assumptions in mind. First, we wanted to compare biological reproducibility of the methods when a similar experiment is performed in different clinical settings and by different scientists, i.e. whether a tool is able to extract biological information common to all heterologous datasets. Second, we did not want to focus on a comparison of how the technical platform influences the results of GS enrichment. Thus, we decided to select a collection of datasets which were described by various authors in diverse clinical studies, but which were all performed on a similar (although not identical) technical platforms (Affymetrix technology).
</p><fig id="btz447-F2" orientation="portrait" position="float"><label>Fig. 2.</label><caption><p>Scheme of reproducibility analysis performed for all tested algorithms</p></caption><graphic xlink:href="btz447f2"/></fig><p>Next to ccRCC datasets, we used 189 KEGG pathways tested by all algorithms after algorithm-specific filtering (<xref ref-type="supplementary-material" rid="sup1">Supplementary File S1</xref>). Previous attempts to estimate consistency of results (Jaakkola and Elo, 2016) were hampered by confounding the replicability with sensitivity. That is, an algorithm which reports no significantly enriched pathways in any of the analyzed datasets at <italic>P</italic> &#x0003c; 5% (due to low sensitivity) may appear consistent (even though it is useless). We sought to alleviate this problem by integrating the outcome over all possible thresholds. Other propositions of reproducibility investigation can be found in <xref rid="btz447-B51" ref-type="bibr">Tarca <italic>et al.</italic> (2009</xref>), <xref rid="btz447-B36" ref-type="bibr">Maleki <italic>et al.</italic> (2018</xref>) and <xref rid="btz447-B60" ref-type="bibr">Zyla <italic>et al.</italic> (2017a</xref>).</p><p>To measure reproducibility, we performed the following procedure for each tested algorithm. First, for each dataset (<xref ref-type="fig" rid="btz447-F2">Fig.&#x000a0;2</xref>, first panel) we applied the given algorithm and obtained a <italic>P</italic>-value for each pathway (<xref ref-type="fig" rid="btz447-F2">Fig.&#x000a0;2</xref>, second panel). Next, for each dataset the obtained <italic>P</italic>-values were ranked (ascending order; tied ranks applied; <xref ref-type="fig" rid="btz447-F2">Fig.&#x000a0;2</xref>, third panel). Specifically, for each dataset, and each of the 189 pathways, we assigned a rank <italic>r<sub>i</sub></italic><sub>,</sub><sub><italic>d</italic></sub> where <italic>i =</italic> 1 &#x02026; 189 is a given pathway and <italic>d =</italic> 1 &#x02026; 6 is a given dataset. We used ranks rather than <italic>P</italic>-values to decouple robustness from sensitivity and specificity. Thus, for a given value of cutoff threshold <italic>t</italic> (1 &#x02026; 189) and each pathway <italic>i</italic>, we calculated the number <italic>n<sub>i</sub></italic><sub>,</sub><sub><italic>t</italic></sub> of datasets in which pathway <italic>i</italic> had a rank below or equal the threshold <italic>t</italic>, that is:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x000a0;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>For example, if a pathway has the ranks 3, 5, 19, 2, 4 and 7 in the six datasets, then for a given threshold <italic>t = 3</italic>, the number <italic>n<sub>i</sub></italic><sub>,</sub><sub><italic>3</italic></sub> of datasets in which this pathway was detected is equal to 2 (<xref ref-type="fig" rid="btz447-F2">Fig.&#x000a0;2</xref>, fourth panel, white part of table). Given the threshold <italic>t</italic>, we then asked how many pathways were detected in at least five datasets. The selection of pathways detected only in five or six datasets is a key point for obtaining information about high reproducibility. This number, standardized by the number of pathways, gives the surrogate reproducibility score, calculated as follows:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mi>s</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mo stretchy="false">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>189</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">&#x000a0;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:mn>5</mml:mn><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>189</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p><p>The rationale behind calculating <italic>s</italic>(<italic>t</italic>) is as follows. A robust algorithm detects the target pathway in all datasets (allowing for a single mistake, hence condition <italic>n<sub>i</sub></italic><sub>,</sub><sub><italic>t</italic></sub> &#x02265; 5) for small values of <italic>t</italic>. By relaxing (increasing) the threshold, any algorithm will eventually detect the pathway in all datasets, but we are interested in algorithms which have a high value of <italic>s</italic>(<italic>t</italic>) at low values of <italic>t</italic> (<xref ref-type="fig" rid="btz447-F2">Fig.&#x000a0;2</xref>, fourth panel, gray part of table). Hence, we consider the dependency between the average number of pathways detected above a certain rank threshold, and the rank threshold used to define the detected pathways&#x02014;that is, between the <italic>s</italic>(<italic>t</italic>) and <italic>t</italic> (<xref ref-type="fig" rid="btz447-F2">Fig.&#x000a0;2</xref>, rightmost panel). Note that <italic>s</italic>(<italic>t</italic>) is monotonic; we define the measure of reproducibility as the area under curve (AUC) of the <italic>s</italic>(<italic>t</italic>) function. The higher the value of AUC, the more reproducible algorithm is.</p><p>The above described procedure was performed on all tested algorithms. In addition, for CERNO algorithm the impact to sensitivity and FPR of applied gene ranking metric was tested by using four different ranking metrics that were most suitable for the GSEA algorithm (<xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>) i.e. Baumgartner&#x02013;Weiss&#x02013;Schindler test statistic (BWS; <xref rid="btz447-B5" ref-type="bibr">Baumgartner <italic>et al.</italic>, 1998</xref>); absolute value from Moderated Welch Test statistics (|MWT|; <xref rid="btz447-B10" ref-type="bibr">Demissie <italic>et al.</italic>, 2008</xref>); absolute value from signal-to-noise ratio (|S2N|; <xref rid="btz447-B47" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>); MSD (<xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>). Notably, the BWS metric makes no assumptions about data distribution. The |S2N| and |MWT| are recommended for normally distributed signals, while MSD can be implemented in a parametric and nonparametric way (in presented study the parametric implementation was used). In addition, the impact of sample size according to different gene ranking metric was performed as in <xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic> (2017b</xref>).</p><p>Finally, due to limitation of GLOBALTEST algorithm in terms of paired design and poor performance of GSEA when <italic>t</italic>-test statistic is used as a ranking metric (<xref rid="btz447-B60" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>), here we used only these 28 benchmark datasets which were suitable for an unpaired study design. Evaluation of GS algorithms on all datasets (including these with paired design) can be found in <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>.</p></sec></sec><sec><title>3 Results</title><sec><title>3.1 Evaluation of different ranking metrics for the CERNO algorithm</title><p>First, we evaluated how ranking metric influences the behavior of the CERNO algorithm. Surrogate sensitivity remained similar across all tested ranking metrics (<xref ref-type="fig" rid="btz447-F3">Fig.&#x000a0;3A</xref>).
</p><fig id="btz447-F3" orientation="portrait" position="float"><label>Fig. 3.</label><caption><p>Comparison of the impact of different gene ranking metric (top row) and sample sizes (bottom row) on the surrogate sensitivity (lower is better) and FPR (closer to 5% is better) for the CERNO algorithm. Panels (<bold>A</bold>) and (<bold>B</bold>) represent impact of different ranking metrics in terms of surrogate sensitivity and FPR at various sample size, respectively. Panels C and D represent impact of sample size to surrogate sensitivity and FPR for MSD metric only. Red line on panels (<bold>B</bold>) and (<bold>D</bold>) represents the expected FPR level</p></caption><graphic xlink:href="btz447f3"/></fig><p>The same measure has been applied previously for the GSEA algorithm (<xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>) and showed a higher variation. Moreover, the number of detected target pathways at <italic>P</italic>-value &#x0003c;5% remained stable for the metrics BWS, |MWT| and |S2N| (21&#x02013;22 out of 28; <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1A</xref>). Slightly lower outcomes in terms of target pathway detection were observed for MSD. Estimated mean FPR was also stable and varied between 8.5% and 10%. The FPR closest to the expected threshold of 5% was observed for MSD metric while the worst outcomes were found for |MWT| (<xref ref-type="fig" rid="btz447-F3">Fig.&#x000a0;3B</xref>), consistent with previous observations (<xref rid="btz447-B61" ref-type="bibr">Zyla <italic>et al.</italic>, 2017b</xref>). Given that the MSD metrics showed the best FPR estimation with acceptable surrogate sensitivity, the impact of sample size for two evaluation statistics was investigated only for this metric (<xref ref-type="fig" rid="btz447-F3">Fig.&#x000a0;3C and D</xref>). Surrogate sensitivity increased with sample size (<xref ref-type="fig" rid="btz447-F3">Fig.&#x000a0;3C</xref>) while FPR remained stable for sample sizes &#x0003e;10. This confirms previous observations, where high level of correlation between the small and large sample sizes was observed for CERNO (<xref rid="btz447-B56" ref-type="bibr">Weiner and Domaszewska, 2016</xref>).</p></sec><sec><title>3.2 Comparison of CERNO to other methods</title><p>We compared the CERNO method to other well-known GSEA methods. For all tested algorithms, we obtained sensitivity <inline-formula id="IE3"><mml:math id="IM3"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> from surrogate sensitivity. Mean FPR was subtracted from expected 5% (|FPR<sub>obs</sub>&#x02013;5%|), computational time was calculated as average evaluation time across all 28 datasets in each algorithm, prioritization was defined as median value from rankings of target pathway in results list and reproducibility was evaluated as detection of common pathways across five and six datasets. This experimental procedure provides one value per each measure and each tested algorithm (<xref rid="btz447-T1" ref-type="table">Table&#x000a0;1</xref>, detailed results for each dataset are induced in <xref ref-type="supplementary-material" rid="sup1">Supplementary File S3 and Fig. S2</xref>). The higher value of sensitivity and reproducibility and lower values of FPR, prioritization and computational time indicate better performance.
</p><table-wrap id="btz447-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Sensitivity, FPR, prioritization, computational time and reproducibility of tested algorithms</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/><col valign="top" align="char" char="." span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Algorithm</th><th rowspan="1" colspan="1">Sensitivity</th><th rowspan="1" colspan="1">FPR</th><th rowspan="1" colspan="1">Time [s]</th><th rowspan="1" colspan="1">Prioritization</th><th rowspan="1" colspan="1">Reproducibility</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">CERNO</td><td rowspan="1" colspan="1">0.949</td><td rowspan="1" colspan="1">3.602</td><td rowspan="1" colspan="1">5.987</td><td rowspan="1" colspan="1">18.73</td><td rowspan="1" colspan="1">
<bold>41.39</bold>
</td></tr><tr><td rowspan="1" colspan="1">GeneSetTest</td><td rowspan="1" colspan="1">0.979</td><td rowspan="1" colspan="1">4.215</td><td rowspan="1" colspan="1">132.557</td><td rowspan="1" colspan="1">14.88</td><td rowspan="1" colspan="1">40.84</td></tr><tr><td rowspan="1" colspan="1">GLOBAL TEST</td><td rowspan="1" colspan="1">0.994</td><td rowspan="1" colspan="1">0.486</td><td rowspan="1" colspan="1">
<bold>2.844</bold>
</td><td rowspan="1" colspan="1">28.38</td><td rowspan="1" colspan="1">35.34</td></tr><tr><td rowspan="1" colspan="1">GSEA</td><td rowspan="1" colspan="1">0.900</td><td rowspan="1" colspan="1">2.696</td><td rowspan="1" colspan="1">289.216</td><td rowspan="1" colspan="1">19.35</td><td rowspan="1" colspan="1">38.60</td></tr><tr><td rowspan="1" colspan="1">GSVA</td><td rowspan="1" colspan="1">0.496</td><td rowspan="1" colspan="1">3.124</td><td rowspan="1" colspan="1">6.335</td><td rowspan="1" colspan="1">40.11</td><td rowspan="1" colspan="1">37.65</td></tr><tr><td rowspan="1" colspan="1">ORA</td><td rowspan="1" colspan="1">0.896</td><td rowspan="1" colspan="1">
<bold>0.067</bold>
</td><td rowspan="1" colspan="1">11.058</td><td rowspan="1" colspan="1">27.07</td><td rowspan="1" colspan="1">36.96</td></tr><tr><td rowspan="1" colspan="1">PADOG</td><td rowspan="1" colspan="1">0.996</td><td rowspan="1" colspan="1">0.082</td><td rowspan="1" colspan="1">71.682</td><td rowspan="1" colspan="1">
<bold>13.86</bold>
</td><td rowspan="1" colspan="1">39.25</td></tr><tr><td rowspan="1" colspan="1">PLAGE</td><td rowspan="1" colspan="1">
<bold>1.000</bold>
</td><td rowspan="1" colspan="1">3.309</td><td rowspan="1" colspan="1">4.508</td><td rowspan="1" colspan="1">23.49</td><td rowspan="1" colspan="1">33.84</td></tr><tr><td rowspan="1" colspan="1">Wilcoxon GST</td><td rowspan="1" colspan="1">0.995</td><td rowspan="1" colspan="1">4.601</td><td rowspan="1" colspan="1">132.557</td><td rowspan="1" colspan="1">17.06</td><td rowspan="1" colspan="1">36.83</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p>
<italic>Note</italic>: Higher values of sensitivity and reproducibility are better; lower values of FPR, prioritization and time are better. For each column, the best value is shown in bold.</p></fn></table-wrap-foot></table-wrap><p>The highest sensitivity was obtained for PLAGE, and most of the other algorithms showed similar results. The lowest sensitivity was observed for GSVA. This confirms previous findings (<xref rid="btz447-B49" ref-type="bibr">Tarca <italic>et al.</italic>, 2013</xref>), where PLAGE was found superior to GSVA. However, PLAGE was shown to overestimate results by lowering GS <italic>P</italic>-values and can mark &#x0003e;70% of pathways as significant even after strict Bonferroni correction (<xref rid="btz447-B60" ref-type="bibr">Zyla <italic>et al.</italic>, 2017a</xref>). Indeed, we found this to be the case in our analysis, as well (<xref ref-type="fig" rid="btz447-F4">Fig.&#x000a0;4</xref>).
</p><fig id="btz447-F4" orientation="portrait" position="float"><label>Fig. 4.</label><caption><p>Percent of significant pathways by average for each algorithm under various <italic>P</italic>-value thresholds across six datasets of ccRCC. The black, dashed, vertical line represents Bonferroni correction for multiple testing</p></caption><graphic xlink:href="btz447f4"/></fig><p>In addition, after Bonferroni correction ORA and PADOG showed very few overall results (on average, respectively 2.44% and 0.91% of all 189 pathways). A number of significant target pathways (at <italic>P</italic>-value &#x0003c;5%) for each tested algorithm are presented in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>B. GSVA show the lowest number of statistically significant target pathways, confirming its low sensitivity, without a tendency to underestimate results (<xref ref-type="fig" rid="btz447-F4">Fig.&#x000a0;4</xref>). ORA and PADOG both detect &#x0003c;40% of target pathways as significant. PLAGE and GLOBALTEST, despite overestimation of results (<xref ref-type="fig" rid="btz447-F4">Fig.&#x000a0;4</xref>), do not detect all target pathways. We next investigated whether observed loss of detection in target pathways are caused by a specific dataset (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1C</xref>). Even though PLAGE did not detect six of the target pathways, only two of these pathways were detected by another algorithm (target pathway for datasets GSE20153 and GSE3585). Similarly, for GLOBALTEST, five target pathways were not detected, and only one of them was identified by another algorithm (dataset GSE20153). Remaining target pathways were successfully observed in other algorithms. These results are consistent with previous comparisons (<xref rid="btz447-B60" ref-type="bibr">Zyla <italic>et al.</italic>, 2017a</xref>). In sum, both PLAGE and GLOBALTEST identified several pathways as positives, while the majority of them of cases could be noise rather than specific for the disease. Assuming that differential gene expression between healthy donors and cancer patients occurs in &#x0223c;10% to 20% of genes (<xref rid="btz447-B3" ref-type="bibr">Anand <italic>et al.</italic>, 2008</xref>), both, the low number of statistically significant pathways in PADOG and ORA and high level of detected pathways in PLAGE and GLOBALTEST are questionable for ccRCC dataset (<xref ref-type="fig" rid="btz447-F4">Fig.&#x000a0;4</xref>). Moreover, it was shown that the PLAGE algorithm has low power and F1 score compared to other single sample methods (<xref rid="btz447-B19" ref-type="bibr">Foroutan <italic>et al.</italic>, 2018</xref>).</p><p>Finally, we investigated impact of GS size and of sample size on the obtained <italic>P</italic>-values of target pathways (surrogate sensitivity). GLOBALTEST, PLAGE were not robust to GS size (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>, test for Spearman rank correlation equality to zero <italic>P</italic>-value &#x0003c;5%). All above mentioned algorithms tended to show lower <italic>P</italic>-values for smaller GS. Stability to sample size (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>) confirmed the observation that CERNO algorithm is robust to sample size in terms of surrogate sensitivity (<xref ref-type="fig" rid="btz447-F3">Fig.&#x000a0;3</xref>) while GLOBALTEST and PLAGE showed lower <italic>P</italic>-values for large datasets (test for Spearman correlation equality to zero with <italic>P</italic>-value &#x0003c;5%).</p><p>The lowest overall FPRs (highest specificity) were observed for ORA and PADOG, which may explain their somewhat lower sensitivity (<xref ref-type="fig" rid="btz447-F4">Fig.&#x000a0;4</xref>). This is in line with a previously published comparison (<xref rid="btz447-B12" ref-type="bibr">Dong <italic>et al.</italic>, 2016</xref>). The least accurate results in terms of FPR testing were observed for the two algorithms from limma package (GeneSetTest and Wilcoxon GST). For all algorithms, the robustness for GS size and sample size in terms of FPR was observed (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S5 and S6</xref>).</p><p>The best outcome for prioritization metric was achieved by the PADOG algorithm. PADOG, despite failing to detect 61% of target pathways at <italic>&#x003b1;</italic> = 5% (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1B</xref>) placed the target pathways at the top of its result list. This contrasts with ORA, which not only failed to detect most of the target pathways at <italic>&#x003b1;</italic> = 5%, but in addition, prioritized the target pathways incorrectly. The poorest performance was observed for GSVA with a likewise low number of detected target pathways (29%, <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1B</xref>). CERNO provides an above average result, correctly prioritizing the target pathways even though, as in the case of PADOG, only 57% of them were statistically significant under the set <italic>&#x003b1;</italic> = 5% (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1B</xref>).</p><p>CERNO had the highest reproducibility, closely followed by GeneSetTest. Both algorithms reached the reproducibility level (AUC) above 40%, returning similar results for the same physiological condition. Furthermore, high level of reproducibility was obtained by PADOG, GSVA and commonly used GSEA method. The poorest outcomes were for PLAGE and GLOBALTEST. This suggests that due to overestimation, PLAGE and GLOBALTEST assign significant <italic>P</italic>-values for a large set of pathways, but these results are inconsistent between different datasets describing the same condition.</p><p>For visualization purposes, we standardized the values presented in <xref rid="btz447-T1" ref-type="table">Table&#x000a0;1</xref>, with 1 being the preferred result (high sensitivity and reproducibility, low FPR, prioritization and CPU time) and 0 the least desirable outcome (<xref ref-type="fig" rid="btz447-F5">Fig.&#x000a0;5</xref>). Based on the obtained normalized scores we calculated the sum from all evaluation measures for each algorithm.
</p><fig id="btz447-F5" orientation="portrait" position="float"><label>Fig. 5.</label><caption><p>Cluster heatmap of normalized evaluation statistics on 28 datasets with unpaired design. Blue color represents good, gray medium and red poor evaluation. Numbers next to the algorithms name represent the overall rank from the best (1) to the worst (9) performance. Dendrogram corresponds to hierarchical clustering based on Euclidian distance</p></caption><graphic xlink:href="btz447f5"/></fig><p>In summary, all tested algorithms except GSVA were sensitive. However, only three algorithms showed a low deviation from expected FPR (PADOG, ORA and GLOBALTEST). The longest calculation times were obtained for the GSEA algorithm due to the permutation test used to assess GS <italic>P</italic>-values. The other algorithms revealed similar computational times. The poorest prioritization was observed for GSVA, GLOBALTEST and medium for ORA, while the remaining algorithms showed acceptable results. Finally, the best reproducibility was observed for CERNO and GeneSetTest, and good for PADOG, GSEA and GSVA. Including all evaluation measures, the best results could be attributed to PADOG (all metrics on acceptable level), CERNO (with a higher than expected FPR) and ORA (with low reproducibility and medium prioritization). Results for all 38 datasets with paired and unpaired design are presented in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S7</xref>. The addition of paired designed datasets does not change top three best algorithms i.e. PADOG, ORA and CERNO.</p><p>Finally, we assessed similarity between algorithm results. To this, we calculated correlation coefficients between pathway <italic>P</italic>-values for each pair of algorithms, separately for the target pathway analysis and for the ccRCC dataset with 189 pathways (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S8</xref>), GSVA did not correlate with any of the tested algorithms. The results of PLAGE correlated with the results of GLOBALTEST and results of GeneSetTest correlated with those of Wilcoxon GST. CERNO algorithm applied to the ccRCC collection (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S8A</xref>) correlated with PADOG and GeneSetTest, but the correlation to PADOG was weaker in case of target pathways (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S8B</xref>). In conclusion, the results of PLAGE, GLOBALTEST and GSVA are least similar to results obtained from the other algorithms.</p></sec></sec><sec><title>4 Discussion</title><p>We have compared the performance of CERNO algorithm implemented in the R package <italic>tmod</italic> with the of several other second generation enrichment algorithms and ORA. We evaluated the algorithms for sensitivity, specificity, prioritization and computational time and introduced a novel measure of result reproducibility. Our testing approach can be easily implemented in future applications.</p><p>We found that CERNO provides stable results in terms of sensitivity and FPR under various gene ranking metrics (<xref ref-type="fig" rid="btz447-F3">Fig.&#x000a0;3A and B</xref>). In addition, it is robust to different sample sizes, except for the smallest sample size tested (10 samples, <xref ref-type="fig" rid="btz447-F3">Fig.&#x000a0;3C and D</xref>). This can be explained by poor estimation of SEM in MSD when the number of samples is small. Given that most of the datasets used for evaluation have small sample size (median sample size was 21), this is consistent with a relatively high FPR. Nevertheless, regardless of the gene ranking metric used, the CERNO algorithm produced sensitive results with constant FPR on the level of 8.5&#x02013;10.5%. A notable feature of the CERNO algorithm is its high reproducibility: findings are consistent across different datasets corresponding to the same physiological state. In addition, it shows above average sensitivity, prioritization and low computational time. Finally, CERNO method use Fisher&#x02019;s method for probabilities integration which assumes the independence of <italic>P</italic>-values tested. This assumption is likely not to be fully met, as gene expression is not independent for many genes, which may result in overstated <italic>P</italic>-values. Our analysis indicates that the FDR for CERNO, while not as good as in case of ORA or PADOG, is better than the one for GeneSetTest or Wilcoxon GST. This confirms that the unmet assumption of independence is, indeed, a problem for CERNO, but it also shows that the impact of this is limited. Implementation of the proposed algorithm along with some visualization tools is publicly available from CRAN (cran.r-project.org/web/packages/tmod/index.html). Several studies successfully used visualization tools included in the <italic>tmod</italic> package in their studies (<xref rid="btz447-B15" ref-type="bibr">El-Chemaly <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B34" ref-type="bibr">Loxton <italic>et al.</italic>, 2016</xref>; <xref rid="btz447-B43" ref-type="bibr">Santoro <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B55" ref-type="bibr">Van Den Berg <italic>et al.</italic>, 2018</xref>; <xref rid="btz447-B57" ref-type="bibr">Weiner <italic>et al.</italic>, 2018</xref>).</p><p>Furthermore, we compared CERNO to several widely used GS enrichment algorithms. PADOG proved the best results under the all tested condition, followed by CERNO and ORA. However, both PADOG and ORA showed a tendency to underestimate results (<xref ref-type="fig" rid="btz447-F4">Fig.&#x000a0;4</xref>). In contrast, PLAGE and GLOBALTEST showed an opposite trend.</p><p>Both PLAGE and GLOBALTEST marked most of the pathways as significantly enriched (74.86% and 76.13% respectively) even after a Bonferroni correction for multiple testing, which in consequence hampers correct conclusions. While both algorithms were previously shown to perform well (<xref rid="btz447-B22" ref-type="bibr">Goeman and B&#x000fc;hlmann, 2007</xref>), we show that they have serious drawbacks not realized before, which may be the reason for the observed low reproducibility between different studies. For PLAGE, PADOG and GLOBALTEST significance level must be chosen carefully to obtain reliable results. This merits further investigation. Moreover, GLOBALTEST and PLAGE are not robust to GS size in terms of results sensitivity.</p><p>Simple first generation GS enrichment approaches based on hypergeometric tests or similar statistical tests of class association (ORA) are still in widespread use. However, ORA requires a cutoff level for division of genes to DEGs and non-DEGs, and consequently in some analyses it is impossible to perform ORA due to lack of DEGs under the selected cutoff. In addition, ORA does not include strength of differentiation or gene position in the ranking list as it is in a functional-class sorting method. In terms of reproducibility, ORA showed an average performance. Though ORA scored relatively high in our comparison due to low FPR, average sensitivity and low computational time, it cannot be recommended for most applications.</p><p>A guide across all results and flexibility of the algorithms can be found in <xref rid="btz447-T2" ref-type="table">Table&#x000a0;2</xref>. In contrast to PADOG and most of other methods, CERNO, GeneSetTest and Wilcoxon GST (all implemented in tmod) allows a choice of gene ranking metric, thus greatly expanding the range of applications. Arbitrary gene metrics include principal component scores, allowing to combine GS enrichment with PCA (implemented in <italic>tmod</italic>) and correlation coefficients, e.g. for the analysis of top clinical correlates of gene expression or for combining gene expression data with other high throughput data types (<xref rid="btz447-B16" ref-type="bibr">Esterhuyse <italic>et al.</italic>, 2015</xref>). CERNO and GeneSetTest show an overall similar performance, with CERNO achieving a better replicability between studies and lower deviation from the expected FPR. Thus, if reproducibility between studies is the main desired criterion, one of these two algorithms is recommended.
</p><table-wrap id="btz447-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Summary of algorithm evaluation and their flexibility</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Algorithm</th><th align="left" rowspan="1" colspan="1">CERNO</th><th align="left" rowspan="1" colspan="1">GeneSetTest</th><th align="left" rowspan="1" colspan="1">GLOBALTEST</th><th align="left" rowspan="1" colspan="1">GSEA</th><th align="left" rowspan="1" colspan="1">GSVA</th><th align="left" rowspan="1" colspan="1">ORA</th><th align="left" rowspan="1" colspan="1">PADOG</th><th align="left" rowspan="1" colspan="1">PLAGE</th><th align="left" rowspan="1" colspan="1">Wilcoxon GST</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Sensitivity</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;&#x02212;</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">++</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td></tr><tr><td rowspan="1" colspan="1">FPR</td><td rowspan="1" colspan="1">&#x02212;</td><td rowspan="1" colspan="1">&#x02212;&#x02212;</td><td rowspan="1" colspan="1">++</td><td rowspan="1" colspan="1">+&#x02212;</td><td rowspan="1" colspan="1">&#x02212;</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;</td><td rowspan="1" colspan="1">&#x02212;&#x02212;</td></tr><tr><td rowspan="1" colspan="1">Time</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;</td><td rowspan="1" colspan="1">++</td><td rowspan="1" colspan="1">&#x02212;&#x02212;</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+&#x02212;</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;</td></tr><tr><td rowspan="1" colspan="1">Prioritization</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;&#x02212;</td><td rowspan="1" colspan="1">+&#x02212;</td><td rowspan="1" colspan="1">++</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td></tr><tr><td rowspan="1" colspan="1">Reproducibility</td><td rowspan="1" colspan="1">++</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;</td><td rowspan="1" colspan="1">+</td><td rowspan="1" colspan="1">&#x02212;&#x02212;</td><td rowspan="1" colspan="1">&#x02212;</td></tr><tr><td rowspan="1" colspan="1">Sensitive to GS size</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td></tr><tr><td rowspan="1" colspan="1">Sensitive to sample size</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes!</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td></tr><tr><td rowspan="1" colspan="1">Data input<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td><td rowspan="1" colspan="1">Ordered gene list</td><td rowspan="1" colspan="1">Ordered gene list</td><td rowspan="1" colspan="1">Expression matrix + class labels</td><td rowspan="1" colspan="1">Expression matrix + class labels</td><td rowspan="1" colspan="1">Expression matrix</td><td rowspan="1" colspan="1">List of DEGs and background</td><td rowspan="1" colspan="1">Expression matrix + class labels</td><td rowspan="1" colspan="1">Expression matrix</td><td rowspan="1" colspan="1">Ordered gene list</td></tr><tr><td rowspan="1" colspan="1">GS input<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td><td rowspan="1" colspan="1">Built-in modules or user input</td><td rowspan="1" colspan="1">User input</td><td rowspan="1" colspan="1">Built-in GSs only</td><td rowspan="1" colspan="1">User input</td><td rowspan="1" colspan="1">User input</td><td rowspan="1" colspan="1">User input</td><td rowspan="1" colspan="1">User input</td><td rowspan="1" colspan="1">User input</td><td rowspan="1" colspan="1">User input</td></tr><tr><td rowspan="1" colspan="1">Alternative ranking metrics<xref ref-type="table-fn" rid="tblfn3"><sup>a</sup></xref></td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">N.A.</td><td rowspan="1" colspan="1">Yes</td><td rowspan="1" colspan="1">No</td><td rowspan="1" colspan="1">N.A.</td><td rowspan="1" colspan="1">Yes</td></tr></tbody></table><table-wrap-foot><fn id="tblfn2"><p>
<italic>Note</italic>: Columns correspond to the algorithms and rows to selection criteria.</p></fn><fn id="tblfn3"><label>a</label><p>Based on available implementation.</p></fn><fn id="tblfn4"><p>N.A., not applicable. &#x02003;The assessment of +/&#x02212; was performed base on <xref rid="btz447-T2" ref-type="table">Table&#x000a0;2</xref> and <xref ref-type="fig" rid="btz447-F5">Figure&#x000a0;5</xref>. Double +/&#x02212; are assign only for the best and the worst algorithm in category. Further the symbols were referred by color class form <xref ref-type="fig" rid="btz447-F5">Figure&#x000a0;5</xref>.</p></fn></table-wrap-foot></table-wrap><p>In conclusion, we evaluated the CERNO enrichment algorithm implemented in <italic>tmod</italic> package in the context of other popular enrichment tools. We showed that CERNO algorithm is robust to different gene ranking lists and sample size. CERNO had the highest reproducibility, good sensitivity, prioritization and low computational time. However, the FPR was average. We introduced a new metric, reproducibility, aimed at measuring the consistency of an algorithm across different studies. Our results provide a useful roadmap for choosing the optimal tool for enrichment analysis.</p><sec><title>Author contributions</title><p>J.W. and T.D. implemented CERNO algorithms and created <italic>tmod</italic> package. J.Z. and M.M. proposed reproducibility metrics and performed evaluation of enrichment algorithms. J.Z. and J.W. wrote the manuscript. All authors conceived the study and participated in interpretation of the results and manuscript preparation. J.Z., M.M., J.P. were incorporated into all calculations and algorithm development that could be described as the performance of tasks in the technical informatics&#x02014;discipline defined by the Polish Ministry of Science and Higher Education.</p></sec></sec><sec><title>Funding</title><p>This work was founded by the Bill &#x00026; Melinda Gates Foundation Grand Challenges in Global Health Program [BMGF GC6-74, #37772 and GC6-2013, OPP1055806]; BioVacSafe 115308, TBVAC 2020 643381 to J.Z., S.K., J.W. and Polish National Science Center [2015/19/B/ST6/01736 to M.M., J.P.]. The calculations were carried out using infrastructure of GeCONiI [POIG.02.03.01-24-099/13].</p><p>
<italic>Conflict of Interest</italic>: none declared.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="sup1"><label>btz447_Supplementary_Data</label><media xlink:href="btz447_supplementary_data.zip"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ref-list id="ref1"><title>References</title><ref id="btz447-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Abatangelo</surname><given-names>L.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Comparative study of gene set enrichment methods</article-title>. <source>BMC Bioinform</source>., <volume>10</volume>, <fpage>275.</fpage></mixed-citation></ref><ref id="btz447-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Alhamdoosh</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Combining multiple tools outperforms individual methods in gene set enrichment analyses</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>414</fpage>&#x02013;<lpage>424</lpage>.<pub-id pub-id-type="pmid">27694195</pub-id></mixed-citation></ref><ref id="btz447-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Anand</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>Cancer is a preventable disease that requires major lifestyle changes</article-title>. <source>Pharm. Res</source>., <volume>25</volume>, <fpage>2097</fpage>&#x02013;<lpage>2116</lpage>.<pub-id pub-id-type="pmid">18626751</pub-id></mixed-citation></ref><ref id="btz447-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Baker</surname><given-names>M.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Is there a reproducibility crisis? A nature survey lifts the lid on how researchers view the crisis rocking science and what they think will help</article-title>. <source>Nature</source>, <volume>533</volume>, <fpage>452</fpage>&#x02013;<lpage>455</lpage>.<pub-id pub-id-type="pmid">27225100</pub-id></mixed-citation></ref><ref id="btz447-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Baumgartner</surname><given-names>W.</given-names></name></person-group>
<etal>et al</etal> (<year>1998</year>) 
<article-title>A nonparametric test for the general two-sample problem</article-title>. <source>Biometrics</source>, <volume>54</volume>, <fpage>1129</fpage>&#x02013;<lpage>1135</lpage>.</mixed-citation></ref><ref id="btz447-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Bayerlov&#x000e1;</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Comparative study on gene set and pathway topology-based enrichment methods</article-title>. <source>BMC Bioinform</source>., <volume>16</volume>, <fpage>334.</fpage></mixed-citation></ref><ref id="btz447-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Chaussabel</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>A modular analysis framework for blood genomics studies: application to systemic lupus erythematosus</article-title>. <source>Immunity</source>, <volume>29</volume>, <fpage>150</fpage>&#x02013;<lpage>164</lpage>.<pub-id pub-id-type="pmid">18631455</pub-id></mixed-citation></ref><ref id="btz447-B8"><mixed-citation publication-type="journal">Consortium, Gene Ontology. (<year>2012</year>) 
<article-title>Gene Ontology annotations and resources</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>D530</fpage>&#x02013;<lpage>535</lpage>.<pub-id pub-id-type="pmid">23161678</pub-id></mixed-citation></ref><ref id="btz447-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Croft</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>The REACTOME pathway knowledgebase</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D472</fpage>&#x02013;<lpage>477</lpage>.<pub-id pub-id-type="pmid">24243840</pub-id></mixed-citation></ref><ref id="btz447-B10"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Demissie</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>Unequal group variances in microarray data analyses</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1168</fpage>&#x02013;<lpage>1174</lpage>.<pub-id pub-id-type="pmid">18344518</pub-id></mixed-citation></ref><ref id="btz447-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Domaszewska</surname><given-names>T.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Concordant and discordant gene expression patterns in mouse strains identify best-fit animal model for human tuberculosis</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>12094.</fpage><pub-id pub-id-type="pmid">28935874</pub-id></mixed-citation></ref><ref id="btz447-B12"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Dong</surname><given-names>X.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>LEGO: a novel method for gene set over-representation analysis by incorporating network-based gene weights</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>18871</fpage>.<pub-id pub-id-type="pmid">26750448</pub-id></mixed-citation></ref><ref id="btz447-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2002</year>) 
<article-title>Gene Expression Omnibus: NCBI gene expression and hybridization array data repository</article-title>. <source>Nucleic Acids Res</source>., <volume>30</volume>, <fpage>207</fpage>&#x02013;<lpage>210</lpage>.<pub-id pub-id-type="pmid">11752295</pub-id></mixed-citation></ref><ref id="btz447-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Efron</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R.</given-names></name></person-group> (<year>2007</year>) 
<article-title>On testing the significance of sets of genes</article-title>. <source>Ann. Appl. Stat</source>., <volume>1</volume>, <fpage>107</fpage>&#x02013;<lpage>129</lpage>.</mixed-citation></ref><ref id="btz447-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>El-Chemaly</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>The immunome in two inherited forms of pulmonary fibrosis</article-title>. <source>Front. Immunol</source>., <volume>9</volume>, <fpage>76.</fpage><pub-id pub-id-type="pmid">29445374</pub-id></mixed-citation></ref><ref id="btz447-B16"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Esterhuyse</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Epigenetics and proteomics join transcriptomics in the quest for tuberculosis biomarkers</article-title>. <source>mBio</source>, <volume>6</volume>, <fpage>e01187</fpage>&#x02013;<lpage>15</lpage>.<pub-id pub-id-type="pmid">26374119</pub-id></mixed-citation></ref><ref id="btz447-B17"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Falcon</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Gentleman</surname><given-names>R.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Using GOstats to test gene lists for GO term association</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>257</fpage>&#x02013;<lpage>258</lpage>.<pub-id pub-id-type="pmid">17098774</pub-id></mixed-citation></ref><ref id="btz447-B18"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Fisher</surname><given-names>R.A.</given-names></name></person-group> (<year>1992</year>) Statistical methods for research workers. In: KotzS. and JohnsonN.L. (eds) <italic>Breakthroughs in Statistics. Springer Series in Statistics (Perspectives in Statistics)</italic>. Springer, New York, NY.</mixed-citation></ref><ref id="btz447-B19"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Foroutan</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Single sample scoring of molecular phenotypes</article-title>. <source>BMC Bioinform</source>., <volume>19</volume>, <fpage>404.</fpage></mixed-citation></ref><ref id="btz447-B20"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Geistlinger</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Bioconductor&#x02019;s EnrichmentBrowser: seamless navigation through combined results of set- &#x00026; network-based enrichment analysis</article-title>. <source>BMC Bioinform</source>., <volume>17</volume>, <fpage>45.</fpage></mixed-citation></ref><ref id="btz447-B21"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Godec</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Compendium of immune signatures identifies conserved and species-specific biology in response to inflammation</article-title>. <source>Immunity</source>, <volume>44</volume>, <fpage>194</fpage>&#x02013;<lpage>206</lpage>.<pub-id pub-id-type="pmid">26795250</pub-id></mixed-citation></ref><ref id="btz447-B22"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Goeman</surname><given-names>J.J.</given-names></name>, <name name-style="western"><surname>B&#x000fc;hlmann</surname><given-names>P.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>980</fpage>&#x02013;<lpage>987</lpage>.<pub-id pub-id-type="pmid">17303618</pub-id></mixed-citation></ref><ref id="btz447-B23"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Goeman</surname><given-names>J.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2004</year>) 
<article-title>A global test for groups of genes: testing association with a clinical outcome</article-title>. <source>Bioinformatics</source>, <volume>20</volume>, <fpage>93</fpage>&#x02013;<lpage>99</lpage>.<pub-id pub-id-type="pmid">14693814</pub-id></mixed-citation></ref><ref id="btz447-B24"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gu</surname><given-names>Z.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>Centrality-based pathway enrichment: a systematic approach for finding significant pathways dominated by key genes</article-title>. <source>BMC Syst. Biol</source>., <volume>6</volume>, <fpage>56.</fpage><pub-id pub-id-type="pmid">22672776</pub-id></mixed-citation></ref><ref id="btz447-B25"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>H&#x000e4;nzelmann</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title>. <source>BMC Bioinform</source>., <volume>14</volume>, <fpage>7.</fpage></mixed-citation></ref><ref id="btz447-B26"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Huang</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>Bioinformatics enrichment tools: paths toward the comprehensive functional analysis of large gene lists</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>1</fpage>&#x02013;<lpage>13</lpage>.<pub-id pub-id-type="pmid">19033363</pub-id></mixed-citation></ref><ref id="btz447-B27"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ihnatova</surname><given-names>I.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>A critical comparison of topology-based pathway analysis methods</article-title>. <source>PLoS One</source>, <volume>13</volume>, <fpage>e0191154.</fpage><pub-id pub-id-type="pmid">29370226</pub-id></mixed-citation></ref><ref id="btz447-B28"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jaakkola</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Elo</surname><given-names>L.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Empirical comparison of structure-based pathway methods</article-title>. <source>Brief Bioinform</source>., <volume>17</volume>, <fpage>336</fpage>&#x02013;<lpage>345</lpage>.<pub-id pub-id-type="pmid">26197809</pub-id></mixed-citation></ref><ref id="btz447-B29"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Jaakkola</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>PASI: a novel pathway method to identify delicate group effects</article-title>. <source>PLoS One</source>, <volume>13</volume>, <fpage>e0199991.</fpage><pub-id pub-id-type="pmid">29975740</pub-id></mixed-citation></ref><ref id="btz447-B30"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>KEGG as a reference resource for gene and protein annotation</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D457</fpage>&#x02013;<lpage>462</lpage>.<pub-id pub-id-type="pmid">26476454</pub-id></mixed-citation></ref><ref id="btz447-B31"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Khatri</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>Ten years of pathway analysis: current approaches and outstanding challenges</article-title>. <source>PLoS Comput. Biol</source>., <volume>8</volume>, <fpage>e1002375.</fpage><pub-id pub-id-type="pmid">22383865</pub-id></mixed-citation></ref><ref id="btz447-B32"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Kunnath-Velayudhan</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2010</year>) 
<article-title>Dynamic antibody responses to the <italic>Mycobacterium tuberculosis</italic> proteome</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>14703</fpage>&#x02013;<lpage>14708</lpage>.<pub-id pub-id-type="pmid">20668240</pub-id></mixed-citation></ref><ref id="btz447-B33"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Molecular signatures of antibody responses derived from a systems biology study of five human vaccines</article-title>. <source>Nat. Immunol</source>., <volume>15</volume>, <fpage>195.</fpage><pub-id pub-id-type="pmid">24336226</pub-id></mixed-citation></ref><ref id="btz447-B34"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Loxton</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>Safety and immunogenicity of the recombinant BCG vaccine VPM1002 in HIV-unexposed newborn infants in South Africa</article-title>. <source>Clin. Vaccine Immunol</source>., <volume>24</volume>, <fpage>00439</fpage>&#x02013;<lpage>16</lpage>.</mixed-citation></ref><ref id="btz447-B35"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Maciejewski</surname><given-names>H.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Gene set analysis methods: statistical models and methodological differences</article-title>. <source>Brief Bioinform</source>., <volume>15</volume>, <fpage>504</fpage>&#x02013;<lpage>518</lpage>.<pub-id pub-id-type="pmid">23413432</pub-id></mixed-citation></ref><ref id="btz447-B36"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Maleki</surname><given-names>F.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) Sample size and reproducibility of gene set analysis. In:<italic> 2018 IEEE International Conference on Bioinformatics and Biomedicine (BIBM), Madrid, Spain, 2018</italic> pp. 122&#x02013;129. <ext-link ext-link-type="uri" xlink:href="https://ieeexplore.ieee.org/abstract/document/8621462">https://ieeexplore.ieee.org/abstract/document/8621462</ext-link>.</mixed-citation></ref><ref id="btz447-B37"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Mathur</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Gene set analysis methods: a systematic comparison</article-title>. <source>BioData Min</source>., <volume>11</volume>, <fpage>8.</fpage><pub-id pub-id-type="pmid">29881462</pub-id></mixed-citation></ref><ref id="btz447-B38"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Mootha</surname><given-names>V.</given-names></name></person-group>
<etal>et al</etal> (<year>2003</year>) 
<article-title>PGC-1&#x003b1;-responsive genes involved in oxidative phosphorylation are coordinately downregulated in human diabetes</article-title>. <source>Nat. Genet</source>., <volume>34</volume>, <fpage>267.</fpage><pub-id pub-id-type="pmid">12808457</pub-id></mixed-citation></ref><ref id="btz447-B39"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Munaf&#x000f2;</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>A manifesto for reproducible science</article-title>. <source>Nat. Hum. Behav</source>., <volume>1</volume>, <fpage>0021.</fpage></mixed-citation></ref><ref id="btz447-B40"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Powers</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>GSEA-InContext: identifying novel and common patterns in expression experiments</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i555</fpage>&#x02013;<lpage>564</lpage>.<pub-id pub-id-type="pmid">29950010</pub-id></mixed-citation></ref><ref id="btz447-B41"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Rahnenf&#x000fc;hrer</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2004</year>) 
<article-title>Calculating the statistical significance of changes in pathway activity from gene expression data</article-title>. <source>Stat. Appl. Genet. Mol. Biol</source>., <volume>3</volume>, <fpage>1</fpage>&#x02013;<lpage>29</lpage>.</mixed-citation></ref><ref id="btz447-B42"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ritchie</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Transcriptomic characterization of MRI contrast with focus on the T1-w/T2-w ratio in the cerebral cortex</article-title>. <source>NeuroImage</source>, <volume>174</volume>, <fpage>504</fpage>&#x02013;<lpage>517</lpage>.<pub-id pub-id-type="pmid">29567503</pub-id></mixed-citation></ref><ref id="btz447-B43"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Santoro</surname><given-names>F.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Transcriptomics of the vaccine immune response: priming with adjuvant modulates recall innate responses after boosting</article-title>. <source>Front. Immunol</source>., <volume>9</volume>, 1248.</mixed-citation></ref><ref id="btz447-B44"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Shojaie</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Michailidis</surname><given-names>G.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Network enrichment analysis in complex experiments</article-title>. <source>Stat. Appl. Genet. Mol. Biol</source>., <volume>9</volume>, 22.</mixed-citation></ref><ref id="btz447-B45"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Smyth</surname><given-names>G.</given-names></name></person-group> (<year>2005</year>) <chapter-title>Limma: linear models for microarray data</chapter-title> In: <source>Bioinformatics and Computational Biology Solutions Using R and Bioconductor.</source><publisher-name>Springer</publisher-name>, New York, NY, pp. <fpage>397</fpage>&#x02013;<lpage>420</lpage>. </mixed-citation></ref><ref id="btz447-B46"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Storey</surname><given-names>J.D.</given-names></name></person-group> (<year>2002</year>) 
<article-title>A direct approach to false discovery rates</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>64</volume>, <fpage>479</fpage>&#x02013;<lpage>498</lpage>.</mixed-citation></ref><ref id="btz447-B47"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Subramanian</surname><given-names>A.</given-names></name></person-group>
<etal>et al</etal> (<year>2005</year>) 
<article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>15545</fpage>&#x02013;<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation></ref><ref id="btz447-B48"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tamayo</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>The limitations of simple gene set enrichment analysis assuming gene independence</article-title>. <source>Stat. Methods Med. Res</source>., <volume>25</volume>, <fpage>472</fpage>&#x02013;<lpage>487</lpage>.<pub-id pub-id-type="pmid">23070592</pub-id></mixed-citation></ref><ref id="btz447-B49"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tarca</surname><given-names>A.L.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>A comparison of gene set analysis methods in terms of sensitivity, prioritization and specificity</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e79217.</fpage><pub-id pub-id-type="pmid">24260172</pub-id></mixed-citation></ref><ref id="btz447-B50"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tarca</surname><given-names>A.L.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>Down-weighting overlapping genes improves gene set analysis</article-title>. <source>BMC Bioinform</source>., <volume>13</volume>, <fpage>136.</fpage></mixed-citation></ref><ref id="btz447-B51"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tarca</surname><given-names>A.L.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>A novel signaling pathway impact analysis</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>75</fpage>&#x02013;<lpage>82</lpage>.<pub-id pub-id-type="pmid">18990722</pub-id></mixed-citation></ref><ref id="btz447-B52"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tavazoie</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>1999</year>) 
<article-title>Systematic determination of genetic network architecture</article-title>. <source>Nat. Genet</source>., <volume>22</volume>, <fpage>281.</fpage><pub-id pub-id-type="pmid">10391217</pub-id></mixed-citation></ref><ref id="btz447-B53"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tomfohr</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2005</year>) 
<article-title>Pathway level analysis of gene expression using singular value decomposition</article-title>. <source>BMC Bioinform</source>., <volume>6</volume>, <fpage>225.</fpage></mixed-citation></ref><ref id="btz447-B54"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Toro&#x02010;Dom&#x000ed;nguez</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Stratification of systemic lupus erythematosus patients into three groups of disease activity progression according to longitudinal gene expression</article-title>. <source>Arthritis Rheumatol</source>., <volume>70</volume>, <fpage>2025</fpage>&#x02013;<lpage>2035</lpage>.<pub-id pub-id-type="pmid">29938934</pub-id></mixed-citation></ref><ref id="btz447-B55"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Van Den Berg</surname><given-names>R.A.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Adjuvant-associated peripheral blood mRNA profiles and kinetics induced by the adjuvanted recombinant protein candidate tuberculosis vaccine M72/AS01 in bacillus Calmette&#x02013;Gu&#x000e9;rin-vaccinated adults</article-title>. <source>Front. Immunol</source>., <volume>9</volume>, <fpage>564</fpage>.<pub-id pub-id-type="pmid">29632533</pub-id></mixed-citation></ref><ref id="btz447-B56"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Weiner</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Domaszewska</surname><given-names>T.</given-names></name></person-group> (<year>2016</year>) <source>tmod: An R Package for General and Multivariate Enrichment Analysis</source>. No. e2420v1. 
<publisher-name>PeerJ Preprints</publisher-name>.</mixed-citation></ref><ref id="btz447-B57"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Weiner</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2018</year>) 
<article-title>Metabolite changes in blood predict the onset of tuberculosis</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>5208.</fpage><pub-id pub-id-type="pmid">30523338</pub-id></mixed-citation></ref><ref id="btz447-B58"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Yamaguchi</surname><given-names>K.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>IFN-&#x003b2;-regulated genes show abnormal expression in therapy-na&#x000ef;ve relapsing&#x02013;remitting MS mononuclear cells: gene expression analysis employing all reported protein&#x02013;protein interactions</article-title>. <source>J. Neuroimmunol</source>., <volume>195</volume>, <fpage>116</fpage>&#x02013;<lpage>120</lpage>.<pub-id pub-id-type="pmid">18279974</pub-id></mixed-citation></ref><ref id="btz447-B59"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>C.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>A strategy for evaluating pathway analysis methods</article-title>. <source>BMC Bioinform</source>., <volume>18</volume>, <fpage>453.</fpage></mixed-citation></ref><ref id="btz447-B60"><mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Zyla</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017a</year>) <chapter-title>Reproducibility of finding enriched gene sets in biological data analysis</chapter-title> In: Fdez-Riverola,F. <italic>et al</italic> (eds), <italic>11th International Conference on Practical Applications of Computational Biology &#x00026; Bioinformatics. PACBB 2017. Advances in Intelligent Systems and Computing</italic>, Vol. 616, Springer, Cham.</mixed-citation></ref><ref id="btz447-B61"><mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zyla</surname><given-names>J.</given-names></name></person-group>
<etal>et al</etal> (<year>2017b</year>) 
<article-title>Ranking metrics in gene set enrichment analysis: do they matter?</article-title><source>BMC Bioinform</source>., <volume>18</volume>, <fpage>256.</fpage></mixed-citation></ref></ref-list></back></article>